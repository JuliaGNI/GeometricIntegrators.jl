<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Problems · GeometricIntegrators.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeometricIntegrators.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Problems</a><ul class="internal"><li><a class="tocitem" href="#Keyword-Arguments"><span>Keyword Arguments</span></a></li><li><a class="tocitem" href="#Ordinary-Differential-Equations-(ODEs)"><span>Ordinary Differential Equations (ODEs)</span></a></li><li><a class="tocitem" href="#Differential-Algebraic-Equation-(DAE)"><span>Differential Algebraic Equation (DAE)</span></a></li><li><a class="tocitem" href="#Stochastic-Differential-Equations-(SDEs)"><span>Stochastic Differential Equations (SDEs)</span></a></li></ul></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><span class="tocitem">Integrators</span><ul><li><a class="tocitem" href="../integrators/rk/">Runge-Kutta</a></li><li><a class="tocitem" href="../integrators/splitting/">Splitting</a></li><li><a class="tocitem" href="../integrators/variational/">Variational</a></li><li><a class="tocitem" href="../integrators/vprk/">VPRK</a></li><li><a class="tocitem" href="../integrators/spark/">SPARK</a></li><li><a class="tocitem" href="../integrators/dvi/">DVI</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../modules/methods/">Methods</a></li><li><a class="tocitem" href="../modules/integrators/">Integrators</a></li><li><a class="tocitem" href="../modules/equations/">Problems</a></li><li><a class="tocitem" href="../modules/solutions/">Solutions</a></li><li><a class="tocitem" href="../modules/rungekutta/">Runge-Kutta Tableaus</a></li><li><a class="tocitem" href="../modules/rungekutta_partitioned/">Partitioned Runge-Kutta Tableaus</a></li><li><a class="tocitem" href="../modules/spark/">SPARK Methods</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="../developer/code_integration/">Code Integration</a></li><li><a class="tocitem" href="../developer/custom_integrators/">Custom Integrators</a></li><li><a class="tocitem" href="../developer/adaptive_time_stepping/">Adaptive Time Stepping</a></li></ul></li><li><a class="tocitem" href="../releasenotes/">Release Notes</a></li><li><a class="tocitem" href="../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../LICENSE/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Problems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Problems</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl/blob/main/docs/src/problems.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Equation-and-Problem-Types"><a class="docs-heading-anchor" href="#Equation-and-Problem-Types">Equation and Problem Types</a><a id="Equation-and-Problem-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-and-Problem-Types" title="Permalink"></a></h1><p>In <em>GeometricIntegrators.jl</em> we support three basic types of equations:</p><ul><li>ordinary differential equations (ODEs),</li><li>differential algebraic equations (DAEs),</li><li>stochastic differential equations (SDEs).</li></ul><p>For each type, there are several subtypes:</p><ul><li>standard equations (<a href="../modules/equations/#GeometricEquations.ODEProblem"><code>ODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.DAEProblem"><code>DAEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.SDEProblem"><code>SDEProblem</code></a>),</li><li>implicit equations (<a href="../modules/equations/#GeometricEquations.IODEProblem"><code>IODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.IDAEProblem"><code>IDAEProblem</code></a>),</li><li>partitioned equations (<a href="../modules/equations/#GeometricEquations.PODEProblem"><code>PODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.PDAEProblem"><code>PDAEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.PSDEProblem"><code>PSDEProblem</code></a>),</li><li>Hamiltonian equations (<a href="../modules/equations/#GeometricEquations.HODEProblem"><code>HODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.HDAEProblem"><code>HDAEProblem</code></a>),</li><li>Lagrangian equations (<a href="../modules/equations/#GeometricEquations.LODEProblem"><code>LODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.LDAEProblem"><code>LDAEProblem</code></a>),</li><li>split equations (<a href="../modules/equations/#GeometricEquations.SODEProblem"><code>SODEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.SPDAEProblem"><code>SPDAEProblem</code></a>, <a href="../modules/equations/#GeometricEquations.SPSDEProblem"><code>SPSDEProblem</code></a>).</li></ul><p>Each equation holds a number of functions determining the vector field, constraints, and possibly additional information like parameters, periodicity, invariants and the Hamiltonian or Lagrangian.</p><p>To each equation type there exists a corresponding problem type, which holds the equation, initial conditions, parameters, a time span to integrate over, as well as a time step (which is typically fixed in GeometricIntegrators). In addition, these problem types provide some convenience constructors to generate the equation and the problem at once.</p><p>All of the equation and problem types are defined in the <a href="https://github.com/JuliaGNI/GeometricEquations.jl">GeometricEquations.jl</a> package. The <a href="https://github.com/JuliaGNI/GeometricProblems.jl">GeometricProblems.jl</a> package implements a number of example problems for testing and benchmarking.</p><h2 id="Keyword-Arguments"><a class="docs-heading-anchor" href="#Keyword-Arguments">Keyword Arguments</a><a id="Keyword-Arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Keyword-Arguments" title="Permalink"></a></h2><p>All equation and problem types take the following keyword arguments:</p><ul><li><code>invariants = NullInvariants()</code></li><li><code>parameters = NullParameters()</code></li><li><code>periodicity = NullPeriodicity()</code></li></ul><p>If not set to their corresponding Null types, the user needs to pass a <code>NamedTuple</code> whose values are</p><ul><li>functions for invariants,</li><li>arbitrary data structures for parameters, </li><li>the same data structure as the solution for periodicity.</li></ul><p>The latter should be zero everywhere, except for those components, that are periodic, i.e., whose value are supposed to stay within a range <code>(0, max)</code>. Support for ranges starting with other values than zero is currently missing but can be added if demand arises.</p><h2 id="Ordinary-Differential-Equations-(ODEs)"><a class="docs-heading-anchor" href="#Ordinary-Differential-Equations-(ODEs)">Ordinary Differential Equations (ODEs)</a><a id="Ordinary-Differential-Equations-(ODEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Ordinary-Differential-Equations-(ODEs)" title="Permalink"></a></h2><p>Ordinary differential equations define an initial value problem of the form</p><p class="math-container">\[\dot{q} (t) = v(t, q(t)) , \qquad q(t_{0}) = q_{0} ,\]</p><p>with vector field <span>$v$</span>, initial condition <span>$q_{0}$</span> and the solution <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>.</p><h4 id="Example:-Harmonic-Oscillator"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator">Example: Harmonic Oscillator</a><a id="Example:-Harmonic-Oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator" title="Permalink"></a></h4><p>As an example, let us consider the harmonic oscillator. The dynamical equations are given by</p><p class="math-container">\[\dot{q} (t) = \begin{pmatrix}
0 &amp; 1 \\
-k &amp; 0 \\
\end{pmatrix} q(t) ,
\qquad
q \in \mathbb{R}^{2} .\]</p><p>In order to create an <code>ODEProblem</code> for the harmonic oscillator, we need to write the following code:</p><pre><code class="language-julia hljs">function v(v, t, x, params)
    v[1] = x[2]
    v[2] = - params.k * x[1]
end

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [0.5, 0.0]

prob = ODEProblem(v, tspan, tstep, q₀; parameters = (k = 0.5,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ODEProblem{Float64, Float64, Vector{Float64}, ODE{typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v,), Tuple{GeometricEquations.var&quot;#13#14&quot;{ODE{typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q,), Tuple{Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(ODE{typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#13#14&quot;{ODE{typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(ODE{typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)),), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0],), (k = 0.5,))</code></pre><p>The energy of the harmonic oscillator is preserved, so we can add it as an invariant, </p><pre><code class="language-julia hljs">energy(t, q, params) = q[2]^2 / 2 + params.k * q[1]^2 / 2

prob = ODEProblem(v, tspan, tstep, q₀; parameters = (k = 0.5,), invariants = (h=energy,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ODEProblem{Float64, Float64, Vector{Float64}, ODE{typeof(Main.v), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v,), Tuple{GeometricEquations.var&quot;#13#14&quot;{ODE{typeof(Main.v), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q,), Tuple{Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(ODE{typeof(Main.v), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#13#14&quot;{ODE{typeof(Main.v), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(ODE{typeof(Main.v), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)),), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0],), (k = 0.5,))</code></pre><h3 id="Partitioned-Ordinary-Differential-Equations-(PODEs)"><a class="docs-heading-anchor" href="#Partitioned-Ordinary-Differential-Equations-(PODEs)">Partitioned Ordinary Differential Equations (PODEs)</a><a id="Partitioned-Ordinary-Differential-Equations-(PODEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Partitioned-Ordinary-Differential-Equations-(PODEs)" title="Permalink"></a></h3><p>A partitioned ordinary differential equation is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) , &amp;
p(t_{0}) &amp;= p_{0} ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span> and <span>$f$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>.</p><h4 id="Example:-Harmonic-Oscillator-2"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator-2">Example: Harmonic Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator-2" title="Permalink"></a></h4><p>As an example, let us consider the harmonic oscillator. The dynamical equations are given by</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= p (t) \\
\dot{p} (t) &amp;= - k \, q(t) .
\end{aligned}\]</p><p>In order to create a <code>PODEProblem</code> for the harmonic oscillator, we need to write the following code:</p><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v[1] = p[1]
end

function f(f, t, q, p, params)
    f[1] = - params.k * q[1]
end

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [0.5]
p₀ = [0.0]

prob = PODEProblem(v, f, tspan, tstep, q₀, p₀; parameters = (k = 0.5,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PODEProblem{Float64, Float64, Vector{Float64}, PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :f), Tuple{GeometricEquations.var&quot;#75#76&quot;{PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#77#78&quot;{PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#75#76&quot;{PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#77#78&quot;{PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0]), (k = 0.5,))</code></pre><p>The energy of the harmonic oscillator is preserved, so we can add it as an invariant, </p><pre><code class="language-julia hljs">energy(t, q, p, params) = p[1]^2 / 2 + params.k * q[1]^2 / 2

prob = PODEProblem(v, f, tspan, tstep, q₀, p₀; parameters = (k = 0.5,), invariants = (h=energy,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PODEProblem{Float64, Float64, Vector{Float64}, PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :f), Tuple{GeometricEquations.var&quot;#75#76&quot;{PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#77#78&quot;{PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#75#76&quot;{PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#77#78&quot;{PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(PODE{typeof(Main.v), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0]), (k = 0.5,))</code></pre><h3 id="Hamiltonian-Ordinary-Differential-Equations-(HODEs)"><a class="docs-heading-anchor" href="#Hamiltonian-Ordinary-Differential-Equations-(HODEs)">Hamiltonian Ordinary Differential Equations (HODEs)</a><a id="Hamiltonian-Ordinary-Differential-Equations-(HODEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Ordinary-Differential-Equations-(HODEs)" title="Permalink"></a></h3><p>A canonical Hamiltonian system of equations is special case of a partitioned ordinary differential equation,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) , &amp; p(t_{0}) &amp;= p_{0} ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span> and <span>$f$</span>, given by</p><p class="math-container">\[\begin{aligned}
v &amp;=   \frac{\partial H}{\partial p} , &amp;
f &amp;= - \frac{\partial H}{\partial q} ,
\end{aligned}\]</p><p>initial conditions <span>$(q_{0}, p_{0})$</span> and the dynamical variables <span>$(q,p)$</span> taking values in <span>$T^{*} Q \simeq \mathbb{R}^{d} \times \mathbb{R}^{d}$</span>.</p><h4 id="Example:-Harmonic-Oscillator-3"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator-3">Example: Harmonic Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator-3" title="Permalink"></a></h4><p>As an example, let us consider the harmonic oscillator. The dynamical equations are given by</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= p (t) \\
\dot{p} (t) &amp;= - k \, q(t) ,
\end{aligned}\]</p><p>which can also be written as </p><p class="math-container">\[\begin{pmatrix}
\dot{q} (t) \\
\dot{p} (t) \\
\end{pmatrix} = \begin{pmatrix}
0 &amp; 1 \\
-1 &amp; 0 \\
\end{pmatrix}
\nabla H( q(t) , p(t) ) ,
\qquad
H(q,p) = \frac{p^2}{2} + k \, \frac{q^2}{2} ,\]</p><p>where <span>$H$</span> is the Hamiltonian, i.e., the total energy of the system.</p><p>In order to create a <code>HODEProblem</code> for the harmonic oscillator, we need to write the following code:</p><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v[1] = p[1]
end

function f(f, t, q, p, params)
    f[1] = - params.k * q[1]
end

h(t, q, p, params) = p[1]^2 / 2 + params.k * q[1]^2 / 2

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [0.5]
p₀ = [0.0]

prob = HODEProblem(v, f, h, tspan, tstep, q₀, p₀; parameters = (k = 0.5,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">HODEProblem{Float64, Float64, Vector{Float64}, HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :f, :h), Tuple{GeometricEquations.var&quot;#21#22&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#23#24&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#25#26&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.h, NullInvariants(), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#21#22&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.h, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#23#24&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.h, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), h = GeometricEquations.var&quot;#25#26&quot;{HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(HODE{typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.h, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0]), (k = 0.5,))</code></pre><h3 id="Implicit-Ordinary-Differential-Equations-(IODEs)"><a class="docs-heading-anchor" href="#Implicit-Ordinary-Differential-Equations-(IODEs)">Implicit Ordinary Differential Equations (IODEs)</a><a id="Implicit-Ordinary-Differential-Equations-(IODEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Ordinary-Differential-Equations-(IODEs)" title="Permalink"></a></h3><p>An implicit ordinary differential equations is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t))
\end{aligned}\]</p><p>with force field <span>$f$</span>, the momentum defined by <span>$p$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>, that is determined such that the constraint <span>$p(t) = ϑ(t, q(t), v(t))$</span> is satisfied.</p><p>Most integrators perform a projection step in order to enforce this constraint. To this end, the system is extended to</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + λ(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), λ(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , &amp;
λ(t_{0}) &amp;= λ_{0}
\end{aligned}\]</p><p>where the vector field defining the projection step is usually given as</p><p class="math-container">\[\begin{aligned}
g(t, q(t), v(t), λ(t)) &amp;= λ(t) \cdot \nabla ϑ(t, q(t), v(t)) .
\end{aligned}\]</p><h4 id="Example:-Harmonic-Oscillator-4"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator-4">Example: Harmonic Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator-4" title="Permalink"></a></h4><p>As an example, let us consider the harmonic oscillator. In implicit form, its equations are given as follows,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , \\
p(t) &amp;= v(t) , \\
\dot{p} (t) &amp;= - k q(t) .
\end{aligned}\]</p><p>Here, <code>v</code> acts as a Lagrange multiplier that enforces the &quot;constraint&quot; <span>$p(t) = v(t)$</span>.</p><p>In order to create an <code>IODEProblem</code> for the harmonic oscillator, we thus need to write the following code:</p><pre><code class="language-julia hljs">function p(p, t, q, v, params)
    p[1] = v[1]
end

function f(f, t, q, v, params)
    p[1] = - params.k * q[1]
end

function g(f, t, q, v, params)
    p[1] = - params.k * q[1]
end

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [0.5]
p₀ = [0.0]

prob = IODEProblem(p, f, tspan, tstep, q₀, p₀; parameters = (k = 0.5,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IODEProblem{Float64, Float64, Vector{Float64}, IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :g, :v̄, :f̄), Tuple{GeometricEquations.var&quot;#33#34&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#35#36&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#37#38&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#39#40&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#41#42&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#33#34&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#35#36&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), g = GeometricEquations.var&quot;#37#38&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), v̄ = GeometricEquations.var&quot;#39#40&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f̄ = GeometricEquations.var&quot;#41#42&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0], λ = [0.0]), (k = 0.5,))</code></pre><p>The energy of the harmonic oscillator is preserved, so we can add it as an invariant, </p><pre><code class="language-julia hljs">energy(t, q, v, params) = v[1]^2 / 2 + params.k * q[1]^2 / 2

prob = IODEProblem(p, f, tspan, tstep, q₀, p₀; parameters = (k = 0.5,), invariants = (h=energy,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IODEProblem{Float64, Float64, Vector{Float64}, IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :g, :v̄, :f̄), Tuple{GeometricEquations.var&quot;#33#34&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#35#36&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#37#38&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#39#40&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#41#42&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#33#34&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#35#36&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), g = GeometricEquations.var&quot;#37#38&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), v̄ = GeometricEquations.var&quot;#39#40&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f̄ = GeometricEquations.var&quot;#41#42&quot;{IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(IODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._iode_default_g), typeof(GeometricEquations._iode_default_v̄), typeof(Main.f), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._iode_default_g, GeometricEquations._iode_default_v̄, Main.f, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0], λ = [0.0]), (k = 0.5,))</code></pre><h3 id="Lagrangian-Ordinary-Differential-Equations-(LODEs)"><a class="docs-heading-anchor" href="#Lagrangian-Ordinary-Differential-Equations-(LODEs)">Lagrangian Ordinary Differential Equations (LODEs)</a><a id="Lagrangian-Ordinary-Differential-Equations-(LODEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian-Ordinary-Differential-Equations-(LODEs)" title="Permalink"></a></h3><p>A Lagrangian system of equations is a special case of an implicit ordinary differential equations, that is an implicit initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t))
\end{aligned}\]</p><p>with momentum <span>$p$</span> and force field <span>$f$</span>, given by</p><p class="math-container">\[\begin{aligned}
p &amp;= \frac{\partial L}{\partial v} , &amp;
f &amp;= \frac{\partial L}{\partial q} ,
\end{aligned}\]</p><p>initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$T^{*} Q \simeq \mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. This is a special case of an implicit ordinary differential equation, that is defined by a Lagrangian, as well as a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>, that is determined such that the constraint <span>$p(t) = ϑ(t, q(t), v(t))$</span> is satisfied.</p><p>Many integrators perform a projection step in order to enforce this constraint. To this end, the system is extended to</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + \lambda(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), \lambda(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , &amp;
\lambda(t_{0}) &amp;= \lambda_{0}
\end{aligned}\]</p><p>where the vector field defining the projection step is usually given as</p><p class="math-container">\[\begin{aligned}
g(t, q(t), v(t), λ(t)) &amp;= λ(t) \cdot \nabla ϑ(t, q(t), v(t)) .
\end{aligned}\]</p><h4 id="Example:-Harmonic-Oscillator-5"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator-5">Example: Harmonic Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator-5" title="Permalink"></a></h4><p>As an example, let us consider the harmonic oscillator. Its Lagrangian is given by</p><p class="math-container">\[L(q, \dot{q}) = \frac{\dot{q}^2}{2} - k \, \frac{q^2}{2} ,\]</p><p>so that the Euler-Lagrange equations</p><p class="math-container">\[\frac{d}{dt} \frac{\partial L}{\partial \dot{q}} = \frac{\partial L}{\partial q} ,\]</p><p>become</p><p class="math-container">\[\ddot{q} (t) = - k q(t) .\]</p><p>Most integrators for Lagrangian systems do not solve this second order system (semi-spray form), but instead use a reformulation as an implicit ordinary differential equation. This formulation can most easily be obtained from a Hamilton-Pontryagin principle</p><p class="math-container">\[\delta \int \limits_{t_0}^{t_1} \big[ L(q, v) + \left&lt; p , \dot{q} - v \right&gt; \big] = 0 ,\]</p><p>as follows,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , \\
p(t) &amp;= \frac{\partial L}{\partial v} (q(t),v(t)) = v(t) , \\
\dot{p} (t) &amp;= \frac{\partial L}{\partial q} (q(t),v(t)) = - k q(t) .
\end{aligned}\]</p><p>Here, <code>v</code> acts as a Lagrange multiplier that enforces the &quot;constraint&quot; <span>$p(t) = \partial L / \partial v$</span>.</p><p>In order to create an <code>LODEProblem</code> for the harmonic oscillator, we thus need to write the following code:</p><pre><code class="language-julia hljs">function p(p, t, q, v, params)
    p[1] = v[1]
end

function f(f, t, q, v, params)
    p[1] = - params.k * q[1]
end

function ω(f, t, q, v, params)
    ω[1,1] =  0
    ω[1,2] = -1
    ω[2,1] = +1
    ω[2,2] =  0
end

function l(t, q, v, params)
    v[1]^2 / 2 - params.k * q[1]^2 / 2
end

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [0.5]
p₀ = [0.0]

prob = LODEProblem(p, f, ω, l, tspan, tstep, q₀, p₀; parameters = (k = 0.5,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LODEProblem{Float64, Float64, Vector{Float64}, LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :g, :ω, :v̄, :f̄, :l), Tuple{GeometricEquations.var&quot;#52#53&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#54#55&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#56#57&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#58#59&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#60#61&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#62#63&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#64#65&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#52#53&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#54#55&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), g = GeometricEquations.var&quot;#56#57&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), ω = GeometricEquations.var&quot;#58#59&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), v̄ = GeometricEquations.var&quot;#60#61&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f̄ = GeometricEquations.var&quot;#62#63&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), l = GeometricEquations.var&quot;#64#65&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0], λ = [0.0]), (k = 0.5,))</code></pre><p>The energy of the harmonic oscillator is preserved, so we can add it as an invariant, </p><pre><code class="language-julia hljs">energy(t, q, v, params) = v[1]^2 / 2 + params.k * q[1]^2 / 2

prob = LODEProblem(p, f, ω, l, tspan, tstep, q₀, p₀; parameters = (k = 0.5,), invariants = (h=energy,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LODEProblem{Float64, Float64, Vector{Float64}, LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :g, :ω, :v̄, :f̄, :l), Tuple{GeometricEquations.var&quot;#52#53&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#54#55&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#56#57&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#58#59&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#60#61&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#62#63&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#64#65&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#52#53&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f = GeometricEquations.var&quot;#54#55&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), g = GeometricEquations.var&quot;#56#57&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), ω = GeometricEquations.var&quot;#58#59&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), v̄ = GeometricEquations.var&quot;#60#61&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), f̄ = GeometricEquations.var&quot;#62#63&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,)), l = GeometricEquations.var&quot;#64#65&quot;{LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(LODE{typeof(Main.p), typeof(Main.f), typeof(GeometricEquations._lode_default_g), typeof(Main.ω), typeof(GeometricEquations._lode_default_v̄), typeof(Main.f), typeof(Main.l), NamedTuple{(:h,), Tuple{typeof(Main.energy)}}, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, GeometricEquations._lode_default_g, Main.ω, GeometricEquations._lode_default_v̄, Main.f, Main.l, (h = Main.energy,), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5], p = [0.0], λ = [0.0]), (k = 0.5,))</code></pre><h2 id="Differential-Algebraic-Equation-(DAE)"><a class="docs-heading-anchor" href="#Differential-Algebraic-Equation-(DAE)">Differential Algebraic Equation (DAE)</a><a id="Differential-Algebraic-Equation-(DAE)-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Algebraic-Equation-(DAE)" title="Permalink"></a></h2><p>Defines a differential algebraic initial value problem</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t)) + u(t, q(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
0 &amp;= \phi (t, q(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{aligned}\]</p><p>with vector field <span>$v$</span>, projection <span>$u$</span>, algebraic constraint <span>$\phi=0$</span>, initial conditions <span>$q_{0}$</span> and <span>$\lambda_{0}$</span>, the dynamical variable <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span> and the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{m}$</span>.</p><p>Some integrators also enforce the secondary constraint <span>$\psi$</span>, that is the time derivative of the algebraic constraint <span>$\phi$</span>. In this case, the system of equations is modified as follows</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t)) + u(t, q(t), \lambda(t)) + \bar{u} (t, q(t), \dot{q} (t), \dot{p} (t), \gamma(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
0 &amp;= \phi (t, q(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} , \\
0 &amp;= \psi (t, q(t), \dot{q} (t)) , &amp; \gamma(t_{0}) &amp;= \gamma_{0} ,
\end{aligned}\]</p><p>with the second algebraic variable <span>$\gamma$</span> also taking values in <span>$\mathbb{R}^{m}$</span>.</p><h3 id="Example:-Harmonic-Oscillator-6"><a class="docs-heading-anchor" href="#Example:-Harmonic-Oscillator-6">Example: Harmonic Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-Oscillator-6" title="Permalink"></a></h3><p>As an example we consider the harmonic oscillator, with an additional constraint that enforces energy conservation. While the system itself is energy conserving, most integrators do not respect this property. A possible way of remedying this flaw is to explicitly add energy conservation as an algebraic constraint. </p><p>The dynamical equations are given by</p><p class="math-container">\[\dot{q} (t) = \begin{pmatrix}
0 &amp; 1 \\
-k &amp; 0 \\
\end{pmatrix} q(t) 
+ \nabla \phi (q(t)) \lambda ,
\qquad
\phi (q) = \frac{q_2^2}{2} + k \, \frac{q_1^2}{2}
\qquad
q \in \mathbb{R}^{2} ,
\qquad
\lambda \in \mathbb{R}^{1} .\]</p><p>In order to create an <code>DAEProblem</code> for the harmonic oscillator including the projection on the constant energy manifold, we need to write the following code:</p><pre><code class="language-julia hljs">hamiltonian(t, q, params) = q[2]^2 / 2 + params.k * q[1]^2 / 2

function v(v, t, q, params)
    v[1] = q[2]
    v[2] = - params.k * q[1]
end

function u(u, t, q, λ, params)
    u[1] = λ[1] * params.k * q[1]
    u[2] = λ[1] * q[2]
end

function ϕ(ϕ, t, q, params)
    ϕ[1] = hamiltonian(t, q, params)
end

tspan = (0.0, 1.0)
tstep = 0.1
q₀ = [1., 1.]
λ₀ = [0.]
params = (k=0.5,)

prob = DAEProblem(v, u, ϕ, tspan, tstep, q₀, λ₀; parameters = params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeometricProblem{DAE, Float64, Float64, Vector{Float64}, DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :u, :ϕ, :v̄), Tuple{GeometricEquations.var&quot;#87#88&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#89#90&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#91#92&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}, GeometricEquations.var&quot;#97#98&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :λ), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:k,), Tuple{Float64}}}(DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.u, Main.ϕ, nothing, nothing, Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#87#88&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.u, Main.ϕ, nothing, nothing, Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), u = GeometricEquations.var&quot;#89#90&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.u, Main.ϕ, nothing, nothing, Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), ϕ = GeometricEquations.var&quot;#91#92&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.u, Main.ϕ, nothing, nothing, Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,)), v̄ = GeometricEquations.var&quot;#97#98&quot;{DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:k,), Tuple{Float64}}}(DAE{typeof(Main.v), typeof(Main.u), typeof(Main.ϕ), Nothing, Nothing, typeof(Main.v), NullInvariants, NamedTuple{(:k,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.u, Main.ϕ, nothing, nothing, Main.v, NullInvariants(), (k = Float64,), NullPeriodicity()), (k = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [1.0, 1.0], λ = [0.0]), (k = 0.5,))</code></pre><h3 id="Partitioned-Differential-Algebraic-Equation-(PDAE)"><a class="docs-heading-anchor" href="#Partitioned-Differential-Algebraic-Equation-(PDAE)">Partitioned Differential Algebraic Equation (PDAE)</a><a id="Partitioned-Differential-Algebraic-Equation-(PDAE)-1"></a><a class="docs-heading-anchor-permalink" href="#Partitioned-Differential-Algebraic-Equation-(PDAE)" title="Permalink"></a></h3><p>A partitioned differential algebraic equation has the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) + u(t, q(t), p(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) + g(t, q(t), p(t), \lambda(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
0 &amp;= \phi (t, q(t), p(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span> and <span>$f$</span>, projection <span>$u$</span> and <span>$g$</span>, algebraic constraint <span>$\phi=0$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and <span>$\lambda_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{m}$</span>.</p><p>Some integrators also enforce the secondary constraint <span>$\psi$</span>, that is the time derivative of the algebraic constraint <span>$\phi$</span>. In this case, the system of equations is modified as follows</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) + u(t, q(t), p(t), \lambda(t)) + \bar{u} (t, q(t), p(t), \gamma(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) + g(t, q(t), p(t), \lambda(t)) + \bar{g} (t, q(t), p(t), \gamma(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
0 &amp;= \phi (t, q(t), p(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} , \\
0 &amp;= \psi (t, q(t), p(t), \dot{q} (t), \dot{p} (t)) , &amp; \gamma(t_{0}) &amp;= \gamma_{0} ,
\end{aligned}\]</p><p>with the second algebraic variable <span>$\gamma$</span> also taking values in <span>$\mathbb{R}^{m}$</span>.</p><h3 id="Example:-Pendulum"><a class="docs-heading-anchor" href="#Example:-Pendulum">Example: Pendulum</a><a id="Example:-Pendulum-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Pendulum" title="Permalink"></a></h3><p>As an example we consider the pendulum in cartesian coordinates, with a constraint that enforces the solution to respect the length of the pendulum.</p><p>The dynamical equations are given by</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= p (t) , &amp;
q &amp;\in \mathbb{R}^{2},
\\
\dot{p} (t) &amp;= 
\begin{pmatrix}
  - \lambda q_1 (t) \\
1 - \lambda q_2 (t) \\
\end{pmatrix} , &amp;
p &amp;\in \mathbb{R}^{2} ,
\\
\phi (q) &amp;= q^2 - l^2 , &amp;
\lambda &amp;\in \mathbb{R}^{1} .
\end{aligned}\]</p><p>In order to create an <code>PDAEProblem</code> for the pendulum including the projection on the constant length constraint, we need to write the following code:</p><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v .= p
end

function f(f, t, q, p, params)
    f[1] = 0
    f[2] = 1
end

function u(u, t, q, p, λ, params)
    u .= 0
end

function g(g, t, q, p, λ, params)
    g[1] = - λ[1] * q[1]
    g[2] = - λ[1] * q[2]
end

function ϕ(ϕ, t, q, p, params)
    ϕ[1] = q[1]^2 + q[2]^2 - params.l^2
end

tspan = (0.0, 1.0)
tstep = 0.1
params = (l=0.5,)

q₀ = [params.l, 0.0]
p₀ = [0.0, 0.1]
λ₀ = [0.0]

prob = PDAEProblem(v, f, u, g, ϕ, tspan, tstep, q₀, p₀, λ₀; parameters = params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PDAEProblem{Float64, Float64, Vector{Float64}, PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :f, :u, :g, :ϕ, :v̄, :f̄), Tuple{GeometricEquations.var&quot;#209#210&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#211#212&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#213#214&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#215#216&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#217#218&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#225#226&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#227#228&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#209#210&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f = GeometricEquations.var&quot;#211#212&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), u = GeometricEquations.var&quot;#213#214&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), g = GeometricEquations.var&quot;#215#216&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), ϕ = GeometricEquations.var&quot;#217#218&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), v̄ = GeometricEquations.var&quot;#225#226&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f̄ = GeometricEquations.var&quot;#227#228&quot;{PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(PDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0], p = [0.0, 0.1], λ = [0.0]), (l = 0.5,))</code></pre><h3 id="Hamiltonian-Differential-Algebraic-Equation-(HDAE)"><a class="docs-heading-anchor" href="#Hamiltonian-Differential-Algebraic-Equation-(HDAE)">Hamiltonian Differential Algebraic Equation (HDAE)</a><a id="Hamiltonian-Differential-Algebraic-Equation-(HDAE)-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Differential-Algebraic-Equation-(HDAE)" title="Permalink"></a></h3><p>A Hamiltonian differential algebraic is an initial value problem, that is a canonical Hamiltonian system of equations subject to Dirac constraints,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) + u(t, q(t), p(t), \lambda(t)) + \bar{u} (t, q(t), p(t), \gamma(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) + g(t, q(t), p(t), \lambda(t)) + \bar{g} (t, q(t), p(t), \gamma(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
0 &amp;= \phi (t, q(t), p(t)) , \\
0 &amp;= \psi (t, q(t), p(t), \dot{q}(t), \dot{p}(t)) ,
\end{aligned}\]</p><p>with vector fields <span>$v$</span>, <span>$u$</span>, <span>$\bar{u}$</span> and <span>$f$</span>, <span>$g$</span>, <span>$\bar{g}$</span>, primary constraint <span>$\phi(q,p)=0$</span> and secondary constraint <span>$\psi(q,p,\dot{q},\dot{p})=0$</span>, initial conditions <span>$(q_{0}, p_{0})$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variables <span>$(\lambda, \gamma)$</span> taking values in <span>$\mathbb{R}^{m} \times \mathbb{R}^{m}$</span>.</p><h3 id="Example:-Pendulum-2"><a class="docs-heading-anchor" href="#Example:-Pendulum-2">Example: Pendulum</a><a class="docs-heading-anchor-permalink" href="#Example:-Pendulum-2" title="Permalink"></a></h3><p>As an example we consider the pendulum in cartesian coordinates, with a constraint that enforces the solution to respect the length of the pendulum.</p><p>The Hamiltonian is given by</p><p class="math-container">\[H(q,p) = \frac{1}{2} p^2 + l - q_2 ,\]</p><p>and dynamical equations read</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= p (t) , &amp;
q &amp;\in \mathbb{R}^{2},
\\
\dot{p} (t) &amp;= 
\begin{pmatrix}
  - \lambda q_1 (t) \\
1 - \lambda q_2 (t) \\
\end{pmatrix} , &amp;
p &amp;\in \mathbb{R}^{2} ,
\\
\phi (q) &amp;= q^2 - l^2 , &amp;
\lambda &amp;\in \mathbb{R}^{1} .
\end{aligned}\]</p><p>In order to create an <code>HDAEProblem</code> for the pendulum including the projection on the constant length constraint, we need to write the following code:</p><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v .= p
end

function f(f, t, q, p, params)
    f[1] = 0
    f[2] = 1
end

function u(u, t, q, p, λ, params)
    u .= 0
end

function g(g, t, q, p, λ, params)
    g[1] = - λ[1] * q[1]
    g[2] = - λ[1] * q[2]
end

function ϕ(ϕ, t, q, p, params)
    ϕ[1] = q[1]^2 + q[2]^2 - params.l^2
end

function h(t, q, p, params)
    return (p[1]^2 + p[2]^2)/2 + params.l - q[2]
end

tspan = (0.0, 1.0)
tstep = 0.1
params = (l=0.5,)

q₀ = [params.l, 0.0]
p₀ = [0.0, 0.1]
λ₀ = [0.0]

prob = HDAEProblem(v, f, u, g, ϕ, h, tspan, tstep, q₀, p₀, λ₀; parameters = params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">HDAEProblem{Float64, Float64, Vector{Float64}, HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:v, :f, :u, :g, :ϕ, :v̄, :f̄, :h), Tuple{GeometricEquations.var&quot;#110#111&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#112#113&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#114#115&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#116#117&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#118#119&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#126#127&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#128#129&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#130#131&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (v = GeometricEquations.var&quot;#110#111&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f = GeometricEquations.var&quot;#112#113&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), u = GeometricEquations.var&quot;#114#115&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), g = GeometricEquations.var&quot;#116#117&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), ϕ = GeometricEquations.var&quot;#118#119&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), v̄ = GeometricEquations.var&quot;#126#127&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f̄ = GeometricEquations.var&quot;#128#129&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), h = GeometricEquations.var&quot;#130#131&quot;{HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(HDAE{typeof(Main.v), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.v), typeof(Main.f), typeof(Main.h), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.v, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.v, Main.f, Main.h, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0], p = [0.0, 0.1], λ = [0.0]), (l = 0.5,))</code></pre><h3 id="Implicit-Differential-Algebraic-Equation-(IDAE)"><a class="docs-heading-anchor" href="#Implicit-Differential-Algebraic-Equation-(IDAE)">Implicit Differential Algebraic Equation (IDAE)</a><a id="Implicit-Differential-Algebraic-Equation-(IDAE)-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Differential-Algebraic-Equation-(IDAE)" title="Permalink"></a></h3><p>An implicit differential algebraic initial value problem takes the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + u(t, q(t), v(t), p(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), p(t), \lambda(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , &amp;&amp; \\
0 &amp;= \phi (t, q(t), v(t), p(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{aligned}\]</p><p>with force field <span>$f$</span>, the momentum defined by <span>$ϑ$</span>, projections <span>$u$</span> and <span>$g$</span>, algebraic constraint <span>$\phi(t,q,v,p)=0$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>, the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{m}$</span>, and initial conditions <span>$(q_{0}, p_{0})$</span> and <span>$\lambda_{0}$</span>.</p><p>Some integrators also enforce the secondary constraint <span>$\psi$</span>, that is the time derivative of the algebraic constraint <span>$\phi$</span>. In this case, the system of equations is modified as follows</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + u(t, q(t), v(t), p(t), \lambda(t)) + \bar{u} (t, q(t), v(t), p(t), \gamma(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), p(t), \lambda(t)) + \bar{g} (t, q(t), v(t), p(t), \gamma(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , &amp;&amp; \\
0 &amp;= \phi (t, q(t), v(t), p(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} , \\
0 &amp;= \psi (t, q(t), v(t), p(t), \dot{q} (t), \dot{p} (t)) , &amp; \gamma(t_{0}) &amp;= \gamma_{0} ,
\end{aligned}\]</p><p>with the second algebraic variable <span>$\gamma$</span> also taking values in <span>$\mathbb{R}^{m}$</span>.</p><h3 id="Example:-Pendulum-3"><a class="docs-heading-anchor" href="#Example:-Pendulum-3">Example: Pendulum</a><a class="docs-heading-anchor-permalink" href="#Example:-Pendulum-3" title="Permalink"></a></h3><p>As an example we consider the pendulum in cartesian coordinates, with a constraint that enforces the solution to respect the length of the pendulum.</p><p>The implicit equations are given by</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , &amp;
q &amp;\in \mathbb{R}^{2},
\\
\dot{p} (t) &amp;= 
\begin{pmatrix}
0 \\
1 \\
\end{pmatrix}
- \lambda(t) q(t) , &amp;
v &amp;\in \mathbb{R}^{2} ,
\\
p(t) &amp;= v(t) , &amp;
p &amp;\in \mathbb{R}^{2} ,
\\
\phi (q) &amp;= q^2 - l^2 , &amp;
\lambda &amp;\in \mathbb{R}^{1} .
\end{aligned}\]</p><p>In order to create an <code>IDAEProblem</code> for the pendulum including the projection on the constant length constraint, we need to write the following code:</p><pre><code class="language-julia hljs">function p(p, t, q, v, params)
    p .= v
end

function f(f, t, q, v, params)
    f[1] = 0
    f[2] = 1
end

function u(u, t, q, v, p, λ, params)
    u .= 0
end

function g(g, t, q, v, p, λ, params)
    g[1] = - λ[1] * q[1]
    g[2] = - λ[1] * q[2]
end

function ϕ(ϕ, t, q, v, p, params)
    ϕ[1] = q[1]^2 + q[2]^2 - params.l^2
end

tspan = (0.0, 1.0)
tstep = 0.1
params = (l=0.5,)

q₀ = [params.l, 0.0]
p₀ = [0.0, 0.1]
λ₀ = [0.0]

prob = IDAEProblem(p, f, u, g, ϕ, tspan, tstep, q₀, p₀, λ₀; parameters = params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IDAEProblem{Float64, Float64, Vector{Float64}, IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :u, :g, :ϕ, :v̄, :f̄), Tuple{GeometricEquations.var&quot;#143#144&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#145#146&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#147#148&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#149#150&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#151#152&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#159#160&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#161#162&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#143#144&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f = GeometricEquations.var&quot;#145#146&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), u = GeometricEquations.var&quot;#147#148&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), g = GeometricEquations.var&quot;#149#150&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), ϕ = GeometricEquations.var&quot;#151#152&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), v̄ = GeometricEquations.var&quot;#159#160&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f̄ = GeometricEquations.var&quot;#161#162&quot;{IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(IDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(GeometricEquations._idae_default_v̄), typeof(Main.f), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, GeometricEquations._idae_default_v̄, Main.f, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0], p = [0.0, 0.1], λ = [0.0]), (l = 0.5,))</code></pre><h3 id="Lagrangian-Differential-Algebraic-Equation-(LDAE)"><a class="docs-heading-anchor" href="#Lagrangian-Differential-Algebraic-Equation-(LDAE)">Lagrangian Differential Algebraic Equation (LDAE)</a><a id="Lagrangian-Differential-Algebraic-Equation-(LDAE)-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian-Differential-Algebraic-Equation-(LDAE)" title="Permalink"></a></h3><p>A special case of an implicit initial value problem is a Lagrangian differential algebraic equation of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) + u(t, q(t), v(t), p(t), \lambda(t)) + \bar{u} (t, q(t), v(t), p(t), \gamma(t)) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), v(t), p(t), \lambda(t)) + \bar{g} (t, q(t), v(t), p(t), \gamma(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , \\
0 &amp;= \phi (t, q(t), v(t), p(t)) , \\
0 &amp;= \psi (t, q(t), v(t), p(t), \dot{q}(t), \dot{p}(t)) ,
\end{aligned}\]</p><p>with momentum <span>$p$</span> and force field <span>$f$</span>, given by</p><p class="math-container">\[\begin{aligned}
p &amp;= \frac{\partial L}{\partial v} (q,v) , &amp;
f &amp;= \frac{\partial L}{\partial q} (q,v) ,
\end{aligned}\]</p><p>projection fields <span>$u$</span>, <span>$\bar{u}$</span> and <span>$g$</span>, <span>$\bar{g}$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variables <span>$(v, \lambda, \gamma)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{m} \times \mathbb{R}^{m}$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variables <span>$v$</span>, <span>$\lambda$</span> and <span>$\gamma$</span>.</p><h3 id="Example:-Pendulum-4"><a class="docs-heading-anchor" href="#Example:-Pendulum-4">Example: Pendulum</a><a class="docs-heading-anchor-permalink" href="#Example:-Pendulum-4" title="Permalink"></a></h3><p>As an example we consider the pendulum in cartesian coordinates, with a constraint that enforces the solution to respect the length of the pendulum.</p><p>The Hamilton-Pontryagin principle for this system is given by</p><p class="math-container">\[\delta \int \limits_{t_0}^{t_1} \big[ L(q, v) + \left&lt; p , \dot{q} - v \right&gt; + \lambda \, \phi (q) \big] = 0 ,\]</p><p>with Lagrangian</p><p class="math-container">\[L(q,v) = \frac{1}{2} v^2 - (l - q_2) ,\]</p><p>and constraint</p><p class="math-container">\[\phi(q) = q^2 - l^2 .\]</p><p>The resulting implicit equations read</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , &amp;
q &amp;\in \mathbb{R}^{2},
\\
\dot{p} (t) &amp;= 
\begin{pmatrix}
0 \\
1 \\
\end{pmatrix}
- \lambda(t) q(t) , &amp;
v &amp;\in \mathbb{R}^{2} ,
\\
p(t) &amp;= v(t) , &amp;
p &amp;\in \mathbb{R}^{2} ,
\\
\phi (q) &amp;= q^2 - l^2 , &amp;
\lambda &amp;\in \mathbb{R}^{1} .
\end{aligned}\]</p><p>In order to create an <code>LDAEProblem</code> for the pendulum including the projection on the constant length constraint, we need to write the following code:</p><pre><code class="language-julia hljs">function p(p, t, q, v, params)
    p .= v
end

function f(f, t, q, v, params)
    f[1] = 0
    f[2] = 1
end

function u(u, t, q, v, p, λ, params)
    u .= 0
end

function g(g, t, q, v, p, λ, params)
    g[1] = - λ[1] * q[1]
    g[2] = - λ[1] * q[2]
end

function ϕ(ϕ, t, q, v, p, params)
    ϕ[1] = q[1]^2 + q[2]^2 - params.l^2
end

function ω(f, t, q, v, params)
    ω[1,1] =  0
    ω[1,2] = -1
    ω[2,1] = +1
    ω[2,2] =  0
end

function l(t, q, v, params)
    return (v[1]^2 + v[2]^2)/2 - (params.l - q[2])
end

tspan = (0.0, 1.0)
tstep = 0.1
params = (l=0.5,)

q₀ = [params.l, 0.0]
p₀ = [0.0, 0.1]
λ₀ = [0.0]

prob = LDAEProblem(p, f, u, g, ϕ, ω, l, tspan, tstep, q₀, p₀, λ₀; parameters = params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LDAEProblem{Float64, Float64, Vector{Float64}, LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:ϑ, :f, :u, :g, :ϕ, :v̄, :f̄, :ω, :l), Tuple{GeometricEquations.var&quot;#174#175&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#176#177&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#178#179&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#180#181&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#182#183&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#190#191&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#192#193&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#194#195&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}, GeometricEquations.var&quot;#196#197&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p, :λ), Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}}}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (ϑ = GeometricEquations.var&quot;#174#175&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f = GeometricEquations.var&quot;#176#177&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), u = GeometricEquations.var&quot;#178#179&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), g = GeometricEquations.var&quot;#180#181&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), ϕ = GeometricEquations.var&quot;#182#183&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), v̄ = GeometricEquations.var&quot;#190#191&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), f̄ = GeometricEquations.var&quot;#192#193&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), ω = GeometricEquations.var&quot;#194#195&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,)), l = GeometricEquations.var&quot;#196#197&quot;{LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}, NamedTuple{(:l,), Tuple{Float64}}}(LDAE{typeof(Main.p), typeof(Main.f), typeof(Main.u), typeof(Main.g), typeof(Main.ϕ), Nothing, Nothing, Nothing, typeof(Main.ω), typeof(GeometricEquations._ldae_default_v̄), typeof(Main.f), typeof(Main.l), NullInvariants, NamedTuple{(:l,), Tuple{DataType}}, NullPeriodicity}(Main.p, Main.f, Main.u, Main.g, Main.ϕ, nothing, nothing, nothing, Main.ω, GeometricEquations._ldae_default_v̄, Main.f, Main.l, NullInvariants(), (l = Float64,), NullPeriodicity()), (l = 0.5,))), NamedTuple(), (0.0, 1.0), 0.1, (q = [0.5, 0.0], p = [0.0, 0.1], λ = [0.0]), (l = 0.5,))</code></pre><h2 id="Stochastic-Differential-Equations-(SDEs)"><a class="docs-heading-anchor" href="#Stochastic-Differential-Equations-(SDEs)">Stochastic Differential Equations (SDEs)</a><a id="Stochastic-Differential-Equations-(SDEs)-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-Differential-Equations-(SDEs)" title="Permalink"></a></h2><p>Defines a stochastic differential initial value problem</p><p class="math-container">\[\begin{aligned}
dq (t) &amp;= v(t, q(t)) \, dt + B(t, q(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} ,
\end{aligned}\]</p><p>with drift vector field <span>$v$</span>, diffusion matrix <span>$B$</span>, initial conditions <span>$q_{0}$</span>, the dynamical variable <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><h4 id="Example:-Kubo-Oscillator"><a class="docs-heading-anchor" href="#Example:-Kubo-Oscillator">Example: Kubo Oscillator</a><a id="Example:-Kubo-Oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Kubo-Oscillator" title="Permalink"></a></h4><pre><code class="language-julia hljs">function v(t, q, v, params)
    v[1] = + params.λ * q[2]
    v[2] = - params.λ * q[1]
end

function B(t, q, B, params)
    for j in axes(B, 2)
        B[1,j] = + params.ν * q[2]
        B[2,j] = - params.ν * q[1]
    end
end

tspan = (0.0, 1.0)
tstep = 0.01
q₀ = [0.5, 0.0]

prob = SDEProblem(v, B, tspan, tstep, q₀; parameters = (λ=2.0, μ=1.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeometricProblem{SDE, Float64, Float64, Vector{Float64}, SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:v, :B), Tuple{GeometricEquations.var&quot;#289#290&quot;{SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#291#292&quot;{SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q,), Tuple{Vector{Float64}}}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.B, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (v = GeometricEquations.var&quot;#289#290&quot;{SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.B, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), B = GeometricEquations.var&quot;#291#292&quot;{SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SDE{typeof(Main.v), typeof(Main.B), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.B, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0))), NamedTuple(), (0.0, 1.0), 0.01, (q = [0.5, 0.0],), (λ = 2.0, μ = 1.0))</code></pre><h3 id="Partitioned-Stochastic-Differential-Equation-(PSDE)"><a class="docs-heading-anchor" href="#Partitioned-Stochastic-Differential-Equation-(PSDE)">Partitioned Stochastic Differential Equation (PSDE)</a><a id="Partitioned-Stochastic-Differential-Equation-(PSDE)-1"></a><a class="docs-heading-anchor-permalink" href="#Partitioned-Stochastic-Differential-Equation-(PSDE)" title="Permalink"></a></h3><p>A partitioned stochastic differential equations is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
dq (t) &amp;= v(t, q(t), p(t)) \, dt + B(t, q(t), p(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} , \\
dp (t) &amp;= f(t, q(t), p(t)) \, dt + G(t, q(t), p(t)) \circ dW , &amp; p(t_{0}) &amp;= p_{0}
\end{aligned}\]</p><p>with the drift vector fields <span>$v$</span> and <span>$f$</span>, diffusion matrices <span>$B$</span> and <span>$G$</span>, initial conditions <span>$q_{0}$</span> and <span>$p_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><h4 id="Example:-Kubo-Oscillator-2"><a class="docs-heading-anchor" href="#Example:-Kubo-Oscillator-2">Example: Kubo Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Kubo-Oscillator-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v[1] = + params.λ * p[1]
end

function f(f, t, q, p, params)
    f[1] = - params.λ * q[1]
end

function B(B, t, q, p, params)
    B[1,1] = params.ν * p[1]
end

function G(G, t, q, p, params)
    G[1,1] = - params.ν * q[1]
end

tspan = (0.0, 1.0)
tstep = 0.01
q₀ = [0.5]
p₀ = [0.0]

prob = PSDEProblem(v, f, B, G, tspan, tstep, q₀, p₀; parameters = (λ=2.0, μ=1.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PSDEProblem{Float64, Float64, Vector{Float64}, PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:v, :f, :B, :G), Tuple{GeometricEquations.var&quot;#298#299&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#300#301&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#302#303&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#304#305&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f, Main.B, Main.G, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (v = GeometricEquations.var&quot;#298#299&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f, Main.B, Main.G, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), f = GeometricEquations.var&quot;#300#301&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f, Main.B, Main.G, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), B = GeometricEquations.var&quot;#302#303&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f, Main.B, Main.G, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), G = GeometricEquations.var&quot;#304#305&quot;{PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(PSDE{typeof(Main.v), typeof(Main.f), typeof(Main.B), typeof(Main.G), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f, Main.B, Main.G, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0))), NamedTuple(), (0.0, 1.0), 0.01, (q = [0.5], p = [0.0]), (λ = 2.0, μ = 1.0))</code></pre><h3 id="Split-Partitioned-Stochastic-Differential-Equation-(SPSDE)"><a class="docs-heading-anchor" href="#Split-Partitioned-Stochastic-Differential-Equation-(SPSDE)">Split Partitioned Stochastic Differential Equation (SPSDE)</a><a id="Split-Partitioned-Stochastic-Differential-Equation-(SPSDE)-1"></a><a class="docs-heading-anchor-permalink" href="#Split-Partitioned-Stochastic-Differential-Equation-(SPSDE)" title="Permalink"></a></h3><p>Defines a partitioned stochastic differential initial value problem</p><p class="math-container">\[\begin{aligned}
dq (t) &amp;=   v(t, q(t), p(t)) \, dt + B(t, q(t), p(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} , \\
dp (t) &amp;= [ f_1(t, q(t), p(t)) + f_2(t, q(t), p(t)) ] \, dt + [ G_1(t, q(t), p(t)) + G_2(t, q(t), p(t)) ] \circ dW , &amp; p(t_{0}) &amp;= p_{0} ,
\end{aligned}\]</p><p>with the drift vector fields <span>$v$</span> and <span>$f_i$</span>, diffusion matrices <span>$B$</span> and <span>$G_i$</span>, initial conditions <span>$q_{0}$</span> and <span>$p_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><h4 id="Example:-Kubo-Oscillator-3"><a class="docs-heading-anchor" href="#Example:-Kubo-Oscillator-3">Example: Kubo Oscillator</a><a class="docs-heading-anchor-permalink" href="#Example:-Kubo-Oscillator-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">function v(v, t, q, p, params)
    v[1] = + params.λ * p[1]
end

function f1(f, t, q, p, params)
    f[1] = - params.λ * q[1]
end

function f2(f, t, q, p, params)
    f[1] = 0
end

function B(B, t, q, p, params)
    B[1,1] = params.ν * p[1]
end

function G1(G, t, q, p, params)
    G[1,1] = - params.ν * q[1]
end

function G2(G, t, q, p, params)
    G[1,1] = 0
end

tspan = (0.0, 1.0)
tstep = 0.01
q₀ = [0.5]
p₀ = [0.0]

prob = SPSDEProblem(v, f1, f2, B, G1, G2, tspan, tstep, q₀, p₀; parameters = (λ=2.0, μ=1.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SPSDEProblem{Float64, Float64, Vector{Float64}, SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:v, :f1, :f2, :B, :G1, :G2), Tuple{GeometricEquations.var&quot;#311#312&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#313#314&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#315#316&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#317#318&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#319#320&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}, GeometricEquations.var&quot;#321#322&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}}}, NamedTuple{(), Tuple{}}, NamedTuple{(:q, :p), Tuple{Vector{Float64}, Vector{Float64}}}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (v = GeometricEquations.var&quot;#311#312&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), f1 = GeometricEquations.var&quot;#313#314&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), f2 = GeometricEquations.var&quot;#315#316&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), B = GeometricEquations.var&quot;#317#318&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), G1 = GeometricEquations.var&quot;#319#320&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0)), G2 = GeometricEquations.var&quot;#321#322&quot;{SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}, NamedTuple{(:λ, :μ), Tuple{Float64, Float64}}}(SPSDE{typeof(Main.v), typeof(Main.f1), typeof(Main.f2), typeof(Main.B), typeof(Main.G1), typeof(Main.G2), NullInvariants, NamedTuple{(:λ, :μ), Tuple{DataType, DataType}}, NullPeriodicity}(Main.v, Main.f1, Main.f2, Main.B, Main.G1, Main.G2, NullInvariants(), (λ = Float64, μ = Float64), NullPeriodicity()), (λ = 2.0, μ = 1.0))), NamedTuple(), (0.0, 1.0), 0.01, (q = [0.5], p = [0.0]), (λ = 2.0, μ = 1.0))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../methods/">Methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 25 July 2023 12:39">Tuesday 25 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
