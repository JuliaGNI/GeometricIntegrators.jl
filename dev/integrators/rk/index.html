<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Runge-Kutta · GeometricIntegrators.jl</title><meta name="title" content="Runge-Kutta · GeometricIntegrators.jl"/><meta property="og:title" content="Runge-Kutta · GeometricIntegrators.jl"/><meta property="twitter:title" content="Runge-Kutta · GeometricIntegrators.jl"/><meta name="description" content="Documentation for GeometricIntegrators.jl."/><meta property="og:description" content="Documentation for GeometricIntegrators.jl."/><meta property="twitter:description" content="Documentation for GeometricIntegrators.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeometricIntegrators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../problems/">Problems</a></li><li><a class="tocitem" href="../../methods/">Methods</a></li><li><span class="tocitem">Integrators</span><ul><li class="is-active"><a class="tocitem" href>Runge-Kutta</a><ul class="internal"><li><a class="tocitem" href="#Common-Runge-Kutta-Methods"><span>Common Runge-Kutta Methods</span></a></li><li><a class="tocitem" href="#Simplifying-Assumptions"><span>Simplifying Assumptions</span></a></li><li><a class="tocitem" href="#Gauß,-Lobatto-and-Radau-Methods"><span>Gauß, Lobatto and Radau Methods</span></a></li><li><a class="tocitem" href="#Partitioned-Equations"><span>Partitioned Equations</span></a></li><li><a class="tocitem" href="#Implicit-Equations"><span>Implicit Equations</span></a></li><li><a class="tocitem" href="#Custom-Tableaus"><span>Custom Tableaus</span></a></li></ul></li><li><a class="tocitem" href="../splitting/">Splitting</a></li><li><a class="tocitem" href="../variational/">Variational</a></li><li><a class="tocitem" href="../vprk/">VPRK</a></li><li><a class="tocitem" href="../spark/">SPARK</a></li><li><a class="tocitem" href="../dvi/">DVI</a></li><li><a class="tocitem" href="../hpi/">Hamilton-Pontryagin</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../../modules/equations/">Equations</a></li><li><a class="tocitem" href="../../modules/integrators/">Integrators</a></li><li><a class="tocitem" href="../../modules/methods/">Methods</a></li><li><a class="tocitem" href="../../modules/problems/">Problems</a></li><li><a class="tocitem" href="../../modules/projections/">Projections</a></li><li><a class="tocitem" href="../../modules/rungekutta/">Runge-Kutta Tableaus</a></li><li><a class="tocitem" href="../../modules/solutions/">Solutions</a></li><li><a class="tocitem" href="../../modules/spark/">SPARK Methods</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="../../developer/integrators/">Integrators</a></li><li><a class="tocitem" href="../../developer/projections/">Projections</a></li><li><a class="tocitem" href="../../developer/code_integration/">Code Integration</a></li><li><a class="tocitem" href="../../developer/custom_integrators/">Custom Integrators</a></li><li><a class="tocitem" href="../../developer/adaptive_time_stepping/">Adaptive Time Stepping</a></li></ul></li><li><a class="tocitem" href="../../releasenotes/">Release Notes</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../LICENSE/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Integrators</a></li><li class="is-active"><a href>Runge-Kutta</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Runge-Kutta</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl/blob/main/docs/src/integrators/rk.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Runge-Kutta-Methods"><a class="docs-heading-anchor" href="#Runge-Kutta-Methods">Runge-Kutta Methods</a><a id="Runge-Kutta-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Runge-Kutta-Methods" title="Permalink"></a></h1><p>Runge-Kutta methods exploit the <strong>Fundamental Theorem of Calculus</strong>, which states that the solution of an initial-value problem</p><p class="math-container">\[\begin{aligned}
\dot{x} (t) &amp;= f(t, x(t)) , &amp;
x(t_{n}) &amp;= x_{n} ,
\end{aligned}\]</p><p>at time <span>$t_{n+1}$</span> is given by</p><p class="math-container">\[x (t_{n+1}) = x (t_{n}) + \int \limits_{t_{n}}^{t_{n+1}} \dot{x} (t) \, dt .\]</p><p>Runge-Kutta methods are constructed by approximating the integral by some quadrature formula with <span>$s$</span> nodes <span>$c_{i}$</span> and corresponding weights <span>$b_{i}$</span> to obtain <span>$x_{n+1} \approx x (t_{n+1})$</span> by</p><p class="math-container">\[\begin{aligned}
x_{n+1} &amp;= x_{n} + h \sum \limits_{i=1}^{s} b_{i} \dot{X}_{n,i} , &amp;
\dot{X}_{n,i} &amp;= f(t_{n} + c_{i} h, X_{n,i}) ,
\end{aligned}\]</p><p>where the internal stage values <span>$X_{n,i} \approx x(t_{n} + c_{i} h)$</span> for <span>$i = 1, ..., s$</span> are determined by another quadrature formula, approximating the integral</p><p class="math-container">\[x(t_{n} + c_{i} h) = x (t_{n}) + \int \limits_{t_{n}}^{t_{n} + c_i h} \dot{x} (t) \, dt ,\]</p><p>namely</p><p class="math-container">\[X_{n,i} = x_{n} + h \sum \limits_{j=1}^{s} a_{ij} \dot{X}_{n,j} ,\]</p><p>with the same vector field values <span>$\dot{X}_{n,j}$</span> used for the computation of <span>$x_{n+1}$</span>.</p><p><strong>Definition:</strong> Runge-Kutta methods are numerical one-step methods</p><p class="math-container">\[\begin{aligned}
X_{n,i} &amp;= x_{n} + h \sum \limits_{j=1}^{s} a_{ij} \, f(t_{n} + c_{j} h, X_{n,j}) , \\
x_{n+1} &amp;= x_{n} + h \sum \limits_{j=1}^{s} b_{j}  \, f(t_{n} + c_{j} h, X_{n,j}) ,
\end{aligned}\]</p><p>defined by a set of nodes <span>$c_i$</span>, weights <span>$b_i$</span> and coefficients <span>$a_{ij}$</span> with <span>$i,j = 1, ..., s$</span>, summarized in the Butcher tableau</p><p class="math-container">\[\begin{array}{c|c}
c &amp; a     \\
\hline
  &amp; b^{T} \\
\end{array}
=
\begin{array}{c|cccc}
c_{1}  &amp; a_{11} &amp; a_{12} &amp; \dots &amp; a_{1s} \\
c_{2}  &amp; a_{21} &amp; a_{22} &amp; \dots &amp; a_{2s} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
c_{s}  &amp; a_{s1} &amp; a_{s2} &amp; \dots &amp; a_{ss} \\
\hline
       &amp; b_{1}  &amp; b_{2}  &amp; \dots &amp; b_{s}  \\
\end{array}\]</p><p>Most properties of the methods, such as order or stability, can be analysed just by posing conditions on the Butcher tableau.</p><h2 id="Common-Runge-Kutta-Methods"><a class="docs-heading-anchor" href="#Common-Runge-Kutta-Methods">Common Runge-Kutta Methods</a><a id="Common-Runge-Kutta-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Runge-Kutta-Methods" title="Permalink"></a></h2><p>GeometricIntegrators.jl provides various explicit and implicit (both diagonally and fully implicit) Runge-Kutta methods. For many methods, tabulated coefficients are included, namely</p><table><tr><th style="text-align: left">Function and Aliases</th><th style="text-align: left">Stages</th><th style="text-align: left">Order</th></tr><tr><td style="text-align: left"><strong>Explicit Methods</strong></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.ExplicitEuler"><code>ExplicitEuler</code></a>, <a href="../../modules/integrators/#GeometricIntegrators.Integrators.ForwardEuler"><code>ForwardEuler</code></a></td><td style="text-align: left">1</td><td style="text-align: left">1</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.ExplicitMidpoint"><code>ExplicitMidpoint</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Heun2"><code>Heun2</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Heun3"><code>Heun3</code></a></td><td style="text-align: left">3</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Kutta3"><code>Kutta3</code></a>, <a href="../../modules/integrators/#GeometricIntegrators.Integrators.Kutta3"><code>Kutta3</code></a></td><td style="text-align: left">3</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Ralston2"><code>Ralston2</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Ralston3"><code>Ralston3</code></a></td><td style="text-align: left">3</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Runge2"><code>Runge2</code></a>, <a href="../../modules/integrators/#GeometricIntegrators.Integrators.Runge2"><code>Runge2</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RK416"><code>RK416</code></a>, <a href="../../modules/integrators/#GeometricIntegrators.Integrators.RK4"><code>RK4</code></a></td><td style="text-align: left">4</td><td style="text-align: left">4</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RK438"><code>RK438</code></a></td><td style="text-align: left">4</td><td style="text-align: left">4</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.SSPRK3"><code>SSPRK3</code></a></td><td style="text-align: left">3</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><strong>Diagonally Implicit Methods</strong></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.CrankNicolson"><code>CrankNicolson</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Crouzeix"><code>Crouzeix</code></a></td><td style="text-align: left">2</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.KraaijevangerSpijker"><code>KraaijevangerSpijker</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.QinZhang"><code>QinZhang</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><strong>Fully Implicit Methods</strong></td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.ImplicitEuler"><code>ImplicitEuler</code></a>, <a href="../../modules/integrators/#GeometricIntegrators.Integrators.BackwardEuler"><code>BackwardEuler</code></a></td><td style="text-align: left">1</td><td style="text-align: left">1</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.ImplicitMidpoint"><code>ImplicitMidpoint</code></a></td><td style="text-align: left">2</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.SRK3"><code>SRK3</code></a></td><td style="text-align: left">3</td><td style="text-align: left">4</td></tr></table><p>The coefficients of other methods are computed on-the-fly as described in the following.</p><h2 id="Simplifying-Assumptions"><a class="docs-heading-anchor" href="#Simplifying-Assumptions">Simplifying Assumptions</a><a id="Simplifying-Assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Simplifying-Assumptions" title="Permalink"></a></h2><p>The construction of many Runge-Kutte methods, in particular the Gauß, Lobatto and Radau methods, relies on the so-called simplifying assumptions:</p><p class="math-container">\[\begin{aligned}
B(\sigma): &amp; \sum \limits_{i=1}^{s} b_{i} c_{i}^{k-1} = \frac{1}{k} , &amp;
k = 1 , \, ... , \, \sigma , \\
%
C(\eta): &amp; \sum \limits_{j=1}^{s} a_{ij} c_{j}^{k-1} = \frac{c_{i}^{k}}{k} , &amp;
i = 1, \, ... , \, s , \; k = 1 , \, ... , \, \eta , \\
%
D(\zeta): &amp; \sum \limits_{i=1}^{s} b_{i} c_{i}^{k-1} a_{ij} = \frac{b_{j}}{k} ( 1 - c_{j}^{k} ) , &amp;
j = 1, \, ... , \, s , \; k = 1 , \, ... , \, \zeta .
\end{aligned}\]</p><p>These assumptions provide order conditions for a Runge-Kutta method given by <span>$(a_{ij}, b_{i}, c_{i})$</span>. The condition <span>$B(p)$</span> implies that the quadrature rule <span>$(b_{i}, c_{i})$</span> is of order <span>$p$</span>. Furthermore, the following theorem holds:</p><p><strong>Theorem (Butcher 1964)</strong>: If the coefficients <span>$(a_{ij}, b_{i}, c_{i})$</span> of a Runge-Kutta method satisfy <span>$B(\sigma)$</span>, <span>$C(\eta)$</span>, <span>$D(\zeta)$</span> with <span>$\sigma \le \eta + \zeta + 1$</span> and <span>$\sigma \le 2 \eta + 2$</span>, then the method is of order <span>$\sigma$</span>.</p><h2 id="Gauß,-Lobatto-and-Radau-Methods"><a class="docs-heading-anchor" href="#Gauß,-Lobatto-and-Radau-Methods">Gauß, Lobatto and Radau Methods</a><a id="Gauß,-Lobatto-and-Radau-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Gauß,-Lobatto-and-Radau-Methods" title="Permalink"></a></h2><p>Gauß methods are collocation methods using the nodes and weights of Gaußian quadrature formulas. The nodes are the zeros of the shifted Legendre polynomials of degree <span>$s$</span>,</p><p class="math-container">\[\frac{d^{s}}{dx^{s}} \big( x^{s} (x-1)^{s} \big) .\]</p><p>In a similar fashion, the nodes of the Radau I and II and the Lobatto III methods are defined as the roots of the polynomials</p><p class="math-container">\[\begin{aligned}
&amp; \frac{d^{s-1}}{dx^{s-1}} \big( x^s (x-1)^{s-1} \big)     &amp;&amp; \text{(Radau I)} , \\
&amp; \frac{d^{s-1}}{dx^{s-1}} \big( x^{s-1} (x-1)^s \big)     &amp;&amp; \text{(Radau II)} , \\
&amp; \frac{d^{s-2}}{dx^{s-2}} \big( x^{s-1} (x-1)^{s-1} \big) &amp;&amp; \text{(Lobatto III)} .
\end{aligned}\]</p><p>The weights <span>$b_{1}, ..., b_{s}$</span> are chosen such that the methods satisfy <span>$B(\sigma)$</span>, that is <span>$B(s)$</span>, for the Gauß methods, <span>$B(s-1)$</span> for the Radau methods, and <span>$B(s-2)$</span> for the Lobatto methods.</p><p>The coefficients <span>$a_{ij}$</span> for <span>$i,j = 1, ..., s$</span> are obtained by the simplifying assumption <span>$C(s)$</span> for the Gauß, Radau IIA and Lobatto IIIA methods, and by the simplifying assumption <span>$D(s)$</span> for the Radau IA and Lobatto IIIB methods. The coefficients of the Lobatto IIIC methods are determined by setting <span>$a_{i,1} = b_1$</span> for <span>$i = 1, ..., s$</span> and solving the simplifying assumption <span>$C(s-1)$</span>, while the coefficients of the Lobatto IIIC̄ methods are determined by setting <span>$a_{i,s} = 0$</span> and solving <span>$C(s-1)$</span>. Note that the Lobatto IIIC̄ methods are sometimes also called Lobatto III or Lobatto III*. For reasons of code symmetry we chose to stick with the less common name Lobatto IIIC̄. The Lobatto IIID and IIIE methods are obtained by combining the tableaus of the Lobatto IIIC and IIIC̄ and the Lobatto IIIA and IIIB methods, respectively, i.e., </p><p class="math-container">\[\begin{aligned}
a_{ij}^{D} &amp;= \tfrac{1}{2} ( a_{ij}^{C} + a_{ij}^{C̄} ) &amp;
&amp; \text{and} &amp;
a_{ij}^{E} &amp;= \tfrac{1}{2} ( a_{ij}^{A} + a_{ij}^{B} ) .
\end{aligned}\]</p><p>While the Lobatto IIIA, IIIB, IIIC and IIIC̄ methods are not symplectic on their own (although the Lobatto IIIA-IIIB and IIIC-IIIC̄ pairs constitute symplectic partitioned Runge-Kutta methods), the Lobatto IIID and IIIE methods are each symplectic by themselves.</p><p>The Gauß methods are of order <span>$2s$</span>, the Radau methods or order <span>$2s-1$</span> and the Lobatto methods are of order <span>$2s-2$</span>, with the exception of the Lobatto IIIF method. This method has been specifically constructed to be of order <span>$2s$</span> as described in [[<a href="../../bibliography/#Fangzong:2016">3</a>]]. The Lobatto IIIG method is constructed in a similar fashion as the Lobatto IIID and IIIE methods by averaging the coefficients of the Lobatto IIIF method with its symplectic complement, i.e.,</p><p class="math-container">\[a_{ij}^{G} = \tfrac{1}{2} ( a_{ij}^{F} + \bar{a}_{ij}^{F} ) ,\]</p><p>where the coffiecients <span>$\bar{a}_{ij}^{F}$</span> are determined by</p><p class="math-container">\[\begin{aligned}
b_{i} \bar{a}^{F}_{ij} + \bar{b}_{j} a^{F}_{ji} &amp;= b_{i} \bar{b}_{j}  &amp;
&amp; \text{and} &amp;
\bar{b}_{i} &amp;= b_{i} .
\end{aligned}\]</p><p>The tableaus of all of the above methods can be computed for an arbitrary number of stages <span>$s$</span> and thus to arbitrary order.</p><h3 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h3><p>The following methods are provided for selecting the previously described Runge-Kutta schemes:</p><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Method</th><th style="text-align: left">Order</th></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.Gauss"><code>Gauss(s)</code></a></td><td style="text-align: left">Gauß-Legendre with s stages</td><td style="text-align: left">2s</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIII"><code>LobattoIII(s)</code></a></td><td style="text-align: left">Lobatto III  with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIA"><code>LobattoIIIA(s)</code></a></td><td style="text-align: left">Lobatto IIIA with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIB"><code>LobattoIIIB(s)</code></a></td><td style="text-align: left">Lobatto IIIB with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIC"><code>LobattoIIIC(s)</code></a></td><td style="text-align: left">Lobatto IIIC with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIID"><code>LobattoIIID(s)</code></a></td><td style="text-align: left">Lobatto IIID with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIE"><code>LobattoIIIE(s)</code></a></td><td style="text-align: left">Lobatto IIIE with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIF"><code>LobattoIIIF(s)</code></a></td><td style="text-align: left">Lobatto IIIF with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIG"><code>LobattoIIIG(s)</code></a></td><td style="text-align: left">Lobatto IIIG with s stages</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RadauIA"><code>RadauIA(s)</code></a></td><td style="text-align: left">Radau IA with s stages</td><td style="text-align: left">2s-1</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RadauIB"><code>RadauIB(s)</code></a></td><td style="text-align: left">Radau IB with s stages</td><td style="text-align: left">2s-1</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RadauIIA"><code>RadauIIA(s)</code></a></td><td style="text-align: left">Radau IIA with s stages</td><td style="text-align: left">2s-1</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.RadauIIB"><code>RadauIIB(s)</code></a></td><td style="text-align: left">Radau IIB with s stages</td><td style="text-align: left">2s-1</td></tr></table><p>The first argument <code>s</code> refers to the number of stages (<span>$s \ge 1$</span> for Gauß and <span>$s \ge 2$</span> for all other methods). The second argument specifies the number type of the coefficients. Internally, all coefficients are computed using <code>BigFloat</code> and then converted to the requested number type, defaulting to <code>Float64</code>.</p><h2 id="Partitioned-Equations"><a class="docs-heading-anchor" href="#Partitioned-Equations">Partitioned Equations</a><a id="Partitioned-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Partitioned-Equations" title="Permalink"></a></h2><p>Partitioned Runge-Kutta methods consist of two tableaus that solve a partitioned ordinary differential equation,</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) , &amp;
p(t_{0}) &amp;= p_{0} ,
\end{aligned}\]</p><p>in the following way:</p><p class="math-container">\[\begin{aligned}
Q_{n,i} &amp;= q_{n} + h \sum \limits_{j=1}^{s} a_{ij} \, v(t_{n} + c_j \Delta t, Q_{n,j}, P_{n,j}) , &amp;
q_{n+1} &amp;= q_{n} + h \sum \limits_{i=1}^{s} b_{i}  \, v(t_{n} + c_j \Delta t, Q_{n,i}, P_{n,i}) , \\
P_{n,i} &amp;= p_{n} + h  \sum \limits_{i=1}^{s} \bar{a}_{ij} \, f(t_{n} + c_j \Delta t, Q_{n,j}, P_{n,j}) , &amp;
p_{n+1} &amp;= p_{n} + h \sum \limits_{i=1}^{s} \bar{b}_{i}   \, f(t_{n} + c_j \Delta t, Q_{n,i}, P_{n,i}) .
\end{aligned}\]</p><p>The <a href="../../modules/rungekutta/#RungeKutta.PartitionedTableau"><code>PartitionedTableau</code></a> data structure can be used to compose any two Runge-Kutta tableaus into a partitioned Runge-Kutta tableau. A particular interesting family of partitioned Runge-Kutta methods are symplectic Lobatto methods, specifically</p><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Method</th><th style="text-align: left">Order</th></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIAIIIB"><code>LobattoIIIAIIIB(s)</code></a></td><td style="text-align: left">Lobatto-IIIA-IIIB</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIBIIIA"><code>LobattoIIIBIIIA(s)</code></a></td><td style="text-align: left">Lobatto-IIIB-IIIA</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIAIIIĀ"><code>LobattoIIIAIIIĀ(s)</code></a></td><td style="text-align: left">Lobatto-IIIA-IIIĀ</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIBIIIB̄"><code>LobattoIIIBIIIB̄(s)</code></a></td><td style="text-align: left">Lobatto-IIIB-IIIB̄</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIICIIIC̄"><code>LobattoIIICIIIC̄(s)</code></a></td><td style="text-align: left">Lobatto-IIIC-IIIC̄</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIC̄IIIC"><code>LobattoIIIC̄IIIC(s)</code></a></td><td style="text-align: left">Lobatto-IIIC̄-IIIC</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIDIIID̄"><code>LobattoIIIDIIID̄(s)</code></a></td><td style="text-align: left">Lobatto-IIID-IIID̄</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIEIIIĒ"><code>LobattoIIIEIIIĒ(s)</code></a></td><td style="text-align: left">Lobatto-IIIE-IIIĒ</td><td style="text-align: left">2s-2</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIFIIIF̄"><code>LobattoIIIFIIIF̄(s)</code></a></td><td style="text-align: left">Lobatto-IIIF-IIIF̄</td><td style="text-align: left">2s</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIF̄IIIF"><code>LobattoIIIF̄IIIF(s)</code></a></td><td style="text-align: left">Lobatto-IIIF̄-IIIF</td><td style="text-align: left">2s</td></tr><tr><td style="text-align: left"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.LobattoIIIGIIIḠ"><code>LobattoIIIGIIIḠ(s)</code></a></td><td style="text-align: left">Lobatto-IIIG-IIIḠ</td><td style="text-align: left">2s</td></tr></table><h2 id="Implicit-Equations"><a class="docs-heading-anchor" href="#Implicit-Equations">Implicit Equations</a><a id="Implicit-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Equations" title="Permalink"></a></h2><p>An implicit ordinary differential equations is an initial value problem of the form</p><p class="math-container">\[\begin{aligned}
\dot{q} (t) &amp;= v(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) .
\end{aligned}\]</p><p>Such problems can be integrated with adapted Runge-Kutta methods, namely</p><p class="math-container">\[\begin{aligned}
Q_{n,i} &amp;= q_{n} + h \sum \limits_{j=1}^{s} a_{ij} \, v(t_{n} + c_j \Delta t, Q_{n,j}, P_{n,j}) , &amp;
q_{n+1} &amp;= q_{n} + h \sum \limits_{i=1}^{s} b_{i}  \, v(t_{n} + c_j \Delta t, Q_{n,i}, P_{n,i}) , \\
P_{n,i} &amp;= p_{n} + h  \sum \limits_{i=1}^{s} \bar{a}_{ij} \, f(t_{n} + c_j \Delta t, Q_{n,j}, P_{n,j}) , &amp;
p_{n+1} &amp;= p_{n} + h \sum \limits_{i=1}^{s} \bar{b}_{i}   \, f(t_{n} + c_j \Delta t, Q_{n,i}, P_{n,i}) , \\
P_{n,i} &amp;= ϑ(t_{n} + c_j \Delta t, Q_{n,j}, P_{n,j}) .
\end{aligned}\]</p><p>Implicit ODEs can be integrated with any implicit Runge-Kutta or partitioned Runge-Kutta method.</p><h2 id="Custom-Tableaus"><a class="docs-heading-anchor" href="#Custom-Tableaus">Custom Tableaus</a><a id="Custom-Tableaus-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Tableaus" title="Permalink"></a></h2><p>If required, it is straight-forward to create a custom tableau. The tableau of Heun&#39;s method, for example, is defined as follows:</p><pre><code class="language-julia hljs">a = [[0.0 0.0]
     [1.0 0.0]]
b = [0.5, 0.5]
c = [0.0, 1.0]
o = 2

tab = Tableau(:heun, o, a, b, c)</code></pre><p>Runge-Kutta Tableau heun with 2 stages and order 2:</p><p class="math-container">\[\begin{array}{r|rr}
  0.0 &amp; 0.0 &amp; 0.0 \\
  1.0 &amp; 1.0 &amp; 0.0 \\\hline
   &amp; 0.5 &amp; 0.5 \\
\end{array}\]</p><p>Here, <code>o</code> is the order of the method, <code>a</code> are the coefficients, <code>b</code> the weights and <code>c</code> the nodes. For partitioned Runge-Kutta tableaus, <code>PartitionedTableau</code> can be used. The first parameter of the constructor of each tableau assigns a name to the tableau. Such custom tableaus can be used in exactly the same as standard tableaus, making it very easy to implement and test new Runge-Kutta methods.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../methods/">« Methods</a><a class="docs-footer-nextpage" href="../splitting/">Splitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 19 January 2024 14:03">Friday 19 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
