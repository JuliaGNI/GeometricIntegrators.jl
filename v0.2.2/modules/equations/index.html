<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Equations · GeometricIntegrators.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GeometricIntegrators.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><span class="tocitem">Integrators</span><ul><li><a class="tocitem" href="../../integrators/">Overview</a></li><li><a class="tocitem" href="../../integrators/splitting/">Splitting</a></li><li><a class="tocitem" href="../../integrators/rk/">Runge-Kutta</a></li><li><a class="tocitem" href="../../integrators/vprk/">VPRK</a></li><li><a class="tocitem" href="../../integrators/spark/">SPARK</a></li><li><a class="tocitem" href="../../integrators/cgvi/">CGVI</a></li><li><a class="tocitem" href="../../integrators/dgvi/">DGVI</a></li><li><a class="tocitem" href="../../integrators/hpg/">HPG</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../basis_functions/">Basis Functions</a></li><li><a class="tocitem" href="../discontinuities/">Discontinuities</a></li><li class="is-active"><a class="tocitem" href>Equations</a></li><li><a class="tocitem" href="../integrators/">Integrators</a></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li><li><a class="tocitem" href="../solvers_linear/">Linear Solvers</a></li><li><a class="tocitem" href="../solvers_nonlinear/">Nonlinear Solvers</a></li><li><a class="tocitem" href="../quadratures/">Quadrature Rules</a></li><li><a class="tocitem" href="../solutions/">Solutions</a></li><li><a class="tocitem" href="../tableaus/">Tableaus</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modules</a></li><li class="is-active"><a href>Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/master/docs/src/modules/equations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Equations-1"><a class="docs-heading-anchor" href="#Equations-1">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.DAE" href="#GeometricIntegrators.Equations.DAE"><code>GeometricIntegrators.Equations.DAE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>DAE</code>: Differential Algebraic Equation</p><p>Defines a differential algebraic initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t, q(t)) + u(t, q(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
0 &amp;= \phi (t, q(t), \lambda(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{align*}\]</div><p>with vector field <span>$v$</span>, projection <span>$u$</span>, algebraic constraint <span>$\phi=0$</span>, initial conditions <span>$q_{0}$</span> and <span>$\lambda_{0}$</span>, the dynamical variable <span>$q$</span> taking values in <span>$\mathbb{R}^{m}$</span> and the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{n}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variable <span>$q$</span> and the vector field <span>$v$</span></li><li><code>m</code>: dimension of algebraic variable <span>$\lambda$</span> and the constraint <span>$\phi$</span></li><li><code>n</code>: number of initial conditions</li><li><code>v</code>: function computing the vector field</li><li><code>u</code>: function computing the projection</li><li><code>ϕ</code>: algebraic constraint</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span></li><li><code>λ₀</code>: initial condition for algebraic variable <span>$\lambda$</span></li></ul><p>The function <code>v</code>, providing the vector field, takes three arguments, <code>v(t, q, v)</code>, the functions <code>u</code> and <code>ϕ</code>, providing the projection and the algebraic constraint take four arguments, <code>u(t, q, λ, u)</code> and <code>ϕ(t, q, λ, ϕ)</code>, where <code>t</code> is the current time, <code>q</code> and <code>λ</code> are the current solution vectors, and <code>v</code>, <code>u</code> and <code>ϕ</code> are the vectors which hold the result of evaluating the vector field <span>$v$</span>, the projection <span>$u$</span> and the algebraic constraint <span>$\phi$</span> on <code>t</code>, <code>q</code> and <code>λ</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">    function v(t, q, v)
        v[1] = q[1]
        v[2] = q[2]
    end

    function u(t, q, λ, u)
        u[1] = +λ[1]
        u[2] = -λ[1]
    end

    function ϕ(t, q, λ, ϕ)
        ϕ[1] = q[2] - q[1]
    end

    t₀ = 0.
    q₀ = [1., 1.]
    λ₀ = [0.]

    dae = DAE(v, u, ϕ, t₀, q₀, λ₀)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/dae.jl#L1-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.HDAE" href="#GeometricIntegrators.Equations.HDAE"><code>GeometricIntegrators.Equations.HDAE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>HDAE</code>: Hamiltonian Differential Algebraic Equation <em>EXPERIMENTAL</em></p><p>Defines a Hamiltonian differential algebraic initial value problem, that is a canonical Hamiltonian system of equations subject to Dirac constraints,</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v_1(t, q(t), p(t)) + v_2(t, q(t), p(t), \lambda(t)) + v_3(t, q(t), p(t), \lambda(t), \gamma(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f_1(t, q(t), p(t)) + f_2(t, q(t), p(t), \lambda(t)) + f_3(t, q(t), p(t), \lambda(t), \gamma(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
0 &amp;= \phi (t, q(t), p(t)) , \\
0 &amp;= \psi (t, q(t), p(t), \dot{q}(t), \dot{p}(t)) ,
\end{align*}\]</div><p>with vector fields <span>$v_i$</span> and <span>$f_i$</span> for <span>$i = 1 ... 3$</span>, primary constraint <span>$\phi(q,p)=0$</span> and secondary constraint <span>$\psi(q,p,\lambda)=0$</span>, initial conditions <span>$(q_{0}, p_{0})$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variables <span>$(\lambda, \gamma)$</span> taking values in <span>$\mathbb{R}^{n} \times \mathbb{R}^{d}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$v$</span> and <span>$f$</span></li><li><code>m</code>: dimension of algebraic variables <span>$\lambda$</span> and <span>$\gamma$</span> and the constraints <span>$\phi$</span> and <span>$\psi$</span></li><li><code>n</code>: number of initial conditions</li><li><code>v</code>: tuple of functions computing the vector fields <span>$v_i$</span>, <span>$i = 1 ... 3$</span></li><li><code>f</code>: tuple of functions computing the vector fields <span>$f_i$</span>, <span>$i = 1 ... 3$</span></li><li><code>ϕ</code>: primary constraints</li><li><code>ψ</code>: secondary constraints</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span></li><li><code>p₀</code>: initial condition for dynamical variable <span>$p$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/hdae.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.IDAE" href="#GeometricIntegrators.Equations.IDAE"><code>GeometricIntegrators.Equations.IDAE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>IDAE</code>: Implicit Differential Algebraic Equation</p><p>Defines a partitioned differential algebraic initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t) + u(t, q(t), p(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + r(t, q(t), p(t), \lambda(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= p(t, q(t), v(t)) , &amp;&amp; \
0 &amp;= \phi (t, q(t), p(t), \lambda(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{align*}\]</div><p>with vector field <span>$f$</span>, the momentum defined by <span>$p$</span>, projection <span>$u$</span> and <span>$r$</span>, algebraic constraint <span>$\phi=0$</span>, conditions <span>$(q_{0}, p_{0})$</span> and <span>$\lambda_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{n}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$f$</span> and <span>$p$</span></li><li><code>m</code>: dimension of algebraic variable <span>$\lambda$</span> and the constraint <span>$\phi$</span></li><li><code>n</code>: number of initial conditions</li><li><code>ϑ</code>: function determining the momentum</li><li><code>f</code>: function computing the vector field <span>$f$</span></li><li><code>u</code>: function computing the projection</li><li><code>g</code>: function computing the projection</li><li><code>ϕ</code>: algebraic constraint</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span></li><li><code>p₀</code>: initial condition for dynamical variable <span>$p$</span></li><li><code>λ₀</code>: initial condition for algebraic variable <span>$\lambda$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/idae.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.IODE" href="#GeometricIntegrators.Equations.IODE"><code>GeometricIntegrators.Equations.IODE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>IODE</code>: Implicit Ordinary Differential Equation</p><p>Defines an implicit initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t))
\end{align*}\]</div><p>with vector field <span>$f$</span>, the momentum defined by <span>$p$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$f$</span> and <span>$p$</span></li><li><code>ϑ</code>: function determining the momentum</li><li><code>f</code>: function computing the vector field</li><li><code>g</code>: function determining the projection, given by ∇ϑ(q)λ</li><li><code>h</code>: function computing the Hamiltonian</li><li><code>v</code>: function computing an initial guess for the velocity field (optional)</li><li><code>t₀</code>: initial time (optional)</li><li><code>q₀</code>: initial condition for <code>q</code></li><li><code>p₀</code>: initial condition for <code>p</code></li></ul><p>The functions <code>ϑ</code> and <code>f</code> must have the interface</p><pre><code class="language-julia">    function ϑ(t, q, v, p)
        p[1] = ...
        p[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function f(t, q, v, f)
        f[1] = ...
        f[2] = ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q</code> is the current solution vector, <code>v</code> is the current velocity and <code>f</code> and <code>p</code> are the vectors which hold the result of evaluating the functions <span>$f$</span> and <span>$ϑ$</span> on <code>t</code>, <code>q</code> and <code>v</code>. In addition, two functions <code>g</code> and <code>v</code> are specified by</p><pre><code class="language-julia">    function g(t, q, λ, g)
        g[1] = ...
        g[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function v(t, q, p, v)
        v[1] = ...
        v[2] = ...
        ...
    end</code></pre><p>The function <code>v</code> is used for initial guesses in nonlinear implicit solvers. The function <code>g</code> is used in projection methods that enforce <span>$p = ϑ(q)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/iode.jl#L1-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.ODE" href="#GeometricIntegrators.Equations.ODE"><code>GeometricIntegrators.Equations.ODE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>ODE</code>: Ordinary Differential Equation</p><p>Defines an initial value problem</p><div>\[\dot{q} (t) = v(t, q(t)) , \qquad q(t_{0}) = q_{0} ,\]</div><p>with vector field <span>$v$</span>, initial condition <span>$q_{0}$</span> and the solution <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variable <span>$q$</span> and the vector field <span>$v$</span></li><li><code>n</code>: number of initial conditions</li><li><code>v</code>: function computing the vector field</li><li><code>h</code>: function computing the Hamiltonian</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition</li></ul><p>The function <code>v</code> providing the vector field must have the interface</p><pre><code class="language-julia">    function v(t, q, v)
        v[1] = ...
        v[2] = ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q</code> is the current solution vector, and <code>v</code> is the vector which holds the result of evaluating the vector field <span>$v$</span> on <code>t</code> and <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/ode.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.PDAE" href="#GeometricIntegrators.Equations.PDAE"><code>GeometricIntegrators.Equations.PDAE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PDAE</code>: Partitioned Differential Algebraic Equation</p><p>Defines a partitioned differential algebraic initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t, q(t), p(t)) + u(t, q(t), p(t), \lambda(t)) , &amp; q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) + r(t, q(t), p(t), \lambda(t)) , &amp; p(t_{0}) &amp;= p_{0} , \\
0 &amp;= \phi (t, q(t), p(t), \lambda(t)) , &amp; \lambda(t_{0}) &amp;= \lambda_{0} ,
\end{align*}\]</div><p>with vector fields <span>$v$</span> and <span>$f$</span>, projection <span>$u$</span> and <span>$r$</span>, algebraic constraint <span>$\phi=0$</span>, conditions <span>$(q_{0}, p_{0})$</span> and <span>$\lambda_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variable <span>$\lambda$</span> taking values in <span>$\mathbb{R}^{n}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$f$</span> and <span>$p$</span></li><li><code>m</code>: dimension of algebraic variable <span>$\lambda$</span> and the constraint <span>$\phi$</span></li><li><code>n</code>: number of initial conditions</li><li><code>v</code>: function computing the vector field <span>$v$</span></li><li><code>f</code>: function computing the vector field <span>$f$</span></li><li><code>u</code>: function computing the projection</li><li><code>g</code>: function computing the projection</li><li><code>ϕ</code>: algebraic constraint</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span></li><li><code>p₀</code>: initial condition for dynamical variable <span>$p$</span></li><li><code>λ₀</code>: initial condition for algebraic variable <span>$\lambda$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/pdae.jl#L1-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.PODE" href="#GeometricIntegrators.Equations.PODE"><code>GeometricIntegrators.Equations.PODE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PODE</code>: Partitioned Ordinary Differential Equation</p><p>Defines a partitioned initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t, q(t), p(t)) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), p(t)) , &amp;
p(t_{0}) &amp;= p_{0} ,
\end{align*}\]</div><p>with vector fields <span>$v$</span> and <span>$f$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$v$</span> and <span>$f$</span></li><li><code>v</code>: function computing the vector field <span>$v$</span></li><li><code>f</code>: function computing the vector field <span>$f$</span></li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for <code>q</code></li><li><code>p₀</code>: initial condition for <code>p</code></li></ul><p>The functions <code>v</code> and <code>f</code> must have the interface</p><pre><code class="language-julia">    function v(t, q, p, v)
        v[1] = ...
        v[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function f(t, q, p, f)
        f[1] = ...
        f[2] = ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q</code> and <code>p</code> are the current solution vectors and <code>v</code> and <code>f</code> are the vectors which hold the result of evaluating the vector fields <span>$v$</span> and <span>$f$</span> on <code>t</code>, <code>q</code> and <code>p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/pode.jl#L1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.PSDE" href="#GeometricIntegrators.Equations.PSDE"><code>GeometricIntegrators.Equations.PSDE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PSDE</code>: Stratonovich Partitioned Stochastic Differential Equation</p><p>Defines a partitioned stochastic differential initial value problem</p><div>\[\begin{align*}
\dq (t) &amp;= v(t, q(t)) \, dt + B(t, q(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} ,
\dp (t) &amp;= f(t, q(t)) \, dt + G(t, q(t)) \circ dW , &amp; p(t_{0}) &amp;= p_{0}
\end{align*}\]</div><p>with the drift vector fields <span>$v$</span> and <span>$f$</span>, diffusion matrices <span>$B$</span> and <span>$G$</span>, initial conditions <span>$q_{0}$</span> and <span>$p_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><p><strong>Fields</strong></p><ul><li><code>d</code>:  dimension of dynamical variable <span>$q$</span> and the vector field <span>$v$</span></li><li><code>m</code>:  dimension of the Wiener process</li><li><code>ni</code>: number of initial conditions</li><li><code>ns</code>: number of sample paths</li><li><code>v</code>:  function computing the drift vector field for the position variable q</li><li><code>f</code>:  function computing the drift vector field for the momentum variable p</li><li><code>B</code>:  function computing the d x m diffusion matrix for the position variable q</li><li><code>G</code>:  function computing the d x m diffusion matrix for the momentum variable p</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span> (may be a random variable itself)</li><li><code>p₀</code>: initial condition for dynamical variable <span>$p$</span> (may be a random variable itself)</li></ul><p>The functions <code>v</code>, <code>f</code>, &#39;B&#39; and <code>G</code>, providing the drift vector fields and diffusion matrices, take four arguments, <code>v(t, q, p, v)</code>, <code>f(t, q, p, f)</code>, <code>B(t, q, p,  B)</code> and <code>G(t, q, p, G)</code>, where <code>t</code> is the current time, <code>(q, p)</code> is the current solution vector, and <code>v</code>, <code>f</code>, &#39;B&#39; and <code>G</code> are the variables which hold the result of evaluating the vector fields <span>$v$</span>, <span>$f$</span> and the matrices <span>$B$</span>, <span>$G$</span> on <code>t</code> and <code>(q,p)</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">    function v(λ, t, q, v)
        v[1] = λ*q[1]
        v[2] = λ*q[2]
    end

    function B(μ, t, q, B)
        B[1] = μ*q[1]
        B[2] = μ*q[2]
    end

    t₀ = 0.
    q₀ = [1., 1.]
    λ  = 2.
    μ  = 1.

    v_sde = (t, q, v) -&gt; v(λ, t, q, v)
    B_sde = (t, q, B) -&gt; B(μ, t, q, B)

    sde = SDE(v_sde, B_sde, t₀, q₀)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/psde.jl#L1-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.SDE" href="#GeometricIntegrators.Equations.SDE"><code>GeometricIntegrators.Equations.SDE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>SDE</code>: Stratonovich Stochastic Differential Equation</p><p>Defines a stochastic differential initial value problem</p><div>\[\begin{align*}
\dq (t) &amp;= v(t, q(t)) \, dt + B(t, q(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} ,
\end{align*}\]</div><p>with drift vector field <span>$v$</span>, diffusion matrix <span>$B$</span>, initial conditions <span>$q_{0}$</span>, the dynamical variable <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><p><strong>Fields</strong></p><ul><li><code>d</code>:  dimension of dynamical variable <span>$q$</span> and the vector field <span>$v$</span></li><li><code>m</code>:  dimension of the Wiener process</li><li><code>ni</code>: number of initial conditions</li><li><code>ns</code>: number of sample paths</li><li><code>v</code>:  function computing the deterministic vector field</li><li><code>B</code>:  function computing the d x m diffusion matrix</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span> (may be a random variable itself)</li></ul><p><strong>Parameters</strong></p><ul><li><code>N</code>: dimension of nitial condition array: N=1 - single, N=2 - multiple</li></ul><p>The functions <code>v</code> and <code>B</code>, providing the drift vector field and diffusion matrix, <code>v(t, q, v)</code> and <code>B(t, q, B, col=0)</code>, where <code>t</code> is the current time, <code>q</code> is the current solution vector, and <code>v</code> and <code>B</code> are the variables which hold the result of evaluating the vector field <span>$v$</span> and the matrix <span>$B$</span> on <code>t</code> and <code>q</code> (if col==0), or the column col of the matrix B (if col&gt;0).</p><p><strong>Example</strong></p><pre><code class="language-julia">    function v(λ, t, q, v)
        v[1] = λ*q[1]
        v[2] = λ*q[2]
    end

    function B(μ, t, q, B; col=0)
        if col==0 #whole matrix
            B[1,1] = μ*q[1]
            B[2,1] = μ*q[2]
        elseif col==1
            #just first column
        end
    end

    t₀ = 0.
    q₀ = [1., 1.]
    λ  = 2.
    μ  = 1.

    v_sde = (t, q, v) -&gt; v(λ, t, q, v)
    B_sde = (t, q, B) -&gt; B(μ, t, q, B)

    sde = SDE(v_sde, B_sde, t₀, q₀)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/sde.jl#L1-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.SODE" href="#GeometricIntegrators.Equations.SODE"><code>GeometricIntegrators.Equations.SODE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>SODE</code>: Split Ordinary Differential Equation</p><p>Defines an initial value problem</p><div>\[\dot{q} (t) = v(t, q(t)) , \qquad q(t_{0}) = q_{0} ,\]</div><p>with vector field <span>$v$</span>, initial condition <span>$q_{0}$</span> and the solution <span>$q$</span> taking values in <span>$\mathbb{R}^{d}$</span>. Here, the vector field <span>$v$</span> is given as a sum of vector fields</p><div>\[v (t) = v_1 (t) + ... + v_r (t) .\]</div><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variable <span>$q$</span> and the vector field <span>$v$</span></li><li><code>v</code>: tuple of functions computing the vector field</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition</li></ul><p>The functions <code>v_i</code> providing the vector field must have the interface</p><pre><code class="language-julia">    function v_i(t, q₀, q₁, h)
        q₁[1] = q₀[1] + ...
        q₁[2] = q₀[2] + ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q₀</code> is the current solution vector, <code>q₁</code> is the new solution vector which holds the result of computing one substep with the vector field <span>$v_i$</span> on <code>t</code> and <code>q₀</code>, and <code>h</code> is the (sub-)timestep to compute the update for.</p><p>The fact that the function <code>v</code> returns the solution and not just the vector field for each substep increases the flexibility for the use of splitting methods, e.g., it allows to use another integrator for solving substeps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/sode.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.SPSDE" href="#GeometricIntegrators.Equations.SPSDE"><code>GeometricIntegrators.Equations.SPSDE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>SPSDE</code>: Stratonovich Split Partitioned Stochastic Differential Equation</p><p>Defines a partitioned stochastic differential initial value problem</p><div>\[\begin{align*}
\dq (t) &amp;=   v(t, q(t)) \, dt + B(t, q(t)) \circ dW , &amp; q(t_{0}) &amp;= q_{0} ,
\dp (t) &amp;= [ f1(t, q(t)) + f2(t, q(t)) ] \, dt + [ G1(t, q(t)) + G2(t, q(t)) ] \circ dW , &amp; p(t_{0}) &amp;= p_{0}
\end{align*}\]</div><p>with the drift vector fields <span>$v$</span> and <span>$fi$</span>, diffusion matrices <span>$B$</span> and <span>$Gi$</span>, initial conditions <span>$q_{0}$</span> and <span>$p_{0}$</span>, the dynamical variables <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>, and the m-dimensional Wiener process W</p><p><strong>Fields</strong></p><ul><li><code>d</code>:  dimension of dynamical variable <span>$q$</span> and the vector fields <span>$vi$</span></li><li><code>m</code>:  dimension of the Wiener process</li><li><code>ni</code>: number of initial conditions</li><li><code>ns</code>: number of sample paths</li><li><code>v</code> :  function computing the drift vector field for the position variable q</li><li><code>f1</code>:  function computing the drift vector field for the momentum variable p</li><li><code>f2</code>:  function computing the drift vector field for the momentum variable p</li><li><code>B</code> :  function computing the d x m diffusion matrix for the position variable q</li><li><code>G1</code>:  function computing the d x m diffusion matrix for the momentum variable p</li><li><code>G2</code>:  function computing the d x m diffusion matrix for the momentum variable p</li><li><code>t₀</code>: initial time</li><li><code>q₀</code>: initial condition for dynamical variable <span>$q$</span> (may be a random variable itself)</li><li><code>p₀</code>: initial condition for dynamical variable <span>$p$</span> (may be a random variable itself)</li></ul><p>The functions <code>v</code>, <code>f</code>, &#39;B&#39; and <code>G</code>, providing the drift vector fields and diffusion matrices, take four arguments, <code>v(t, q, p, v)</code>, <code>f(t, q, p, f)</code>, <code>B(t, q, p,  B)</code> and <code>G(t, q, p, G)</code>, where <code>t</code> is the current time, <code>(q, p)</code> is the current solution vector, and <code>v</code>, <code>f</code>, &#39;B&#39; and <code>G</code> are the variables which hold the result of evaluating the vector fields <span>$v$</span>, <span>$f$</span> and the matrices <span>$B$</span>, <span>$G$</span> on <code>t</code> and <code>(q,p)</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">    function v(λ, t, q, v)
        v[1] = λ*q[1]
        v[2] = λ*q[2]
    end

    function B(μ, t, q, B)
        B[1] = μ*q[1]
        B[2] = μ*q[2]
    end

    t₀ = 0.
    q₀ = [1., 1.]
    λ  = 2.
    μ  = 1.

    v_sde = (t, q, v) -&gt; v(λ, t, q, v)
    B_sde = (t, q, B) -&gt; B(μ, t, q, B)

    sde = SDE(v_sde, B_sde, t₀, q₀)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/spsde.jl#L1-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.VDAE" href="#GeometricIntegrators.Equations.VDAE"><code>GeometricIntegrators.Equations.VDAE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>VDAE</code>: Variational Differential Algebraic Equation <em>EXPERIMENTAL</em></p><p>Defines an implicit initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t) + λ(t), &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) + g(t, q(t), λ(t)) + \obar{g}(t, q(t), μ(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t)) , \\
0 &amp;= \phi (t, q(t), p(t)) , \\
0 &amp;= \psi (t, q(t), p(t), \dot{q}(t), \dot{p}(t)) ,
\end{align*}\]</div><p>with vector field <span>$f$</span>, the momentum defined by <span>$p$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span> and the algebraic variables <span>$(v, \lambda, \mu)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d} \times \mathbb{R}^{m}$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variables <span>$v$</span>, <span>$\lambda$</span> and <span>$\mu$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$f$</span> and <span>$p$</span></li><li><code>ϑ</code>: function determining the momentum</li><li><code>f</code>: function computing the vector field</li><li><code>g</code>: function determining the primary projection, usually given by ∇ϑ(q)⋅λ</li><li><code>g̅</code>: function determining the secondary projection, usually given by λ⋅∇ϑ(q)</li><li><code>ϕ</code>: primary constraints, usually given by p-ϑ(q)</li><li><code>ψ</code>: secondary constraints, usually given by ṗ-q̇⋅∇ϑ(q)</li><li><code>v</code>: function computing an initial guess for the velocity field (optional)</li><li><code>Ω</code>: symplectic matrix (optional)</li><li><code>∇H</code>: gradient of the Hamiltonian (optional)</li><li><code>t₀</code>: initial time (optional)</li><li><code>q₀</code>: initial condition for <code>q</code></li><li><code>p₀</code>: initial condition for <code>p</code></li><li><code>λ₀</code>: initial condition for <code>λ</code> (optional)</li><li><code>μ₀</code>: initial condition for <code>μ</code> (optional)</li></ul><p>The functions <code>ϑ</code> and <code>f</code> must have the interface</p><pre><code class="language-julia">    function ϑ(t, q, v, p)
        p[1] = ...
        p[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function f(t, q, v, f)
        f[1] = ...
        f[2] = ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q</code> is the current solution vector, <code>v</code> is the current velocity and <code>f</code> and <code>p</code> are the vectors which hold the result of evaluating the functions <span>$f$</span> and <span>$ϑ$</span> on <code>t</code>, <code>q</code> and <code>v</code>. The funtions <code>g</code> and <code>v</code> are specified by</p><pre><code class="language-julia">    function g(t, q, λ, g)
        g[1] = ...
        g[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function v(t, q, p, v)
        v[1] = ...
        v[2] = ...
        ...
    end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/vdae.jl#L1-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GeometricIntegrators.Equations.VODE" href="#GeometricIntegrators.Equations.VODE"><code>GeometricIntegrators.Equations.VODE</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>VODE</code>: Variational Ordinary Differential Equation <em>EXPERIMENTAL</em></p><p>Defines an implicit initial value problem</p><div>\[\begin{align*}
\dot{q} (t) &amp;= v(t) , &amp;
q(t_{0}) &amp;= q_{0} , \\
\dot{p} (t) &amp;= f(t, q(t), v(t)) , &amp;
p(t_{0}) &amp;= p_{0} , \\
p(t) &amp;= ϑ(t, q(t), v(t))
\end{align*}\]</div><p>with vector field <span>$f$</span>, the momentum defined by <span>$p$</span>, initial conditions <span>$(q_{0}, p_{0})$</span> and the solution <span>$(q,p)$</span> taking values in <span>$\mathbb{R}^{d} \times \mathbb{R}^{d}$</span>. This is a special case of a differential algebraic equation with dynamical variables <span>$(q,p)$</span> and algebraic variable <span>$v$</span>.</p><p><strong>Fields</strong></p><ul><li><code>d</code>: dimension of dynamical variables <span>$q$</span> and <span>$p$</span> as well as the vector fields <span>$f$</span> and <span>$p$</span></li><li><code>ϑ</code>: function determining the momentum</li><li><code>f</code>: function computing the vector field</li><li><code>g</code>: function determining the projection, given by ∇ϑ(q)⋅λ</li><li><code>v</code>: function computing an initial guess for the velocity field (optional)</li><li><code>Ω</code>: symplectic matrix (optional)</li><li><code>∇H</code>: gradient of the Hamiltonian (optional)</li><li><code>t₀</code>: initial time (optional)</li><li><code>q₀</code>: initial condition for <code>q</code></li><li><code>p₀</code>: initial condition for <code>p</code></li><li><code>λ₀</code>: initial condition for <code>λ</code> (optional)</li></ul><p>The functions <code>ϑ</code> and <code>f</code> must have the interface</p><pre><code class="language-julia">    function ϑ(t, q, v, p)
        p[1] = ...
        p[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function f(t, q, v, f)
        f[1] = ...
        f[2] = ...
        ...
    end</code></pre><p>where <code>t</code> is the current time, <code>q</code> is the current solution vector, <code>v</code> is the current velocity and <code>f</code> and <code>p</code> are the vectors which hold the result of evaluating the functions <span>$f$</span> and <span>$ϑ$</span> on <code>t</code>, <code>q</code> and <code>v</code>. The funtions <code>g</code> and <code>v</code> are specified by</p><pre><code class="language-julia">    function g(t, q, λ, g)
        g[1] = ...
        g[2] = ...
        ...
    end</code></pre><p>and</p><pre><code class="language-julia">    function v(t, q, p, v)
        v[1] = ...
        v[2] = ...
        ...
    end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/GeometricIntegrators.jl/blob/d2f25d48893665ada021016c8037b64d73771253/src/equations/vode.jl#L1-L68">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../discontinuities/">« Discontinuities</a><a class="docs-footer-nextpage" href="../integrators/">Integrators »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 10 February 2020 14:39">Monday 10 February 2020</span>. Using Julia version 1.1.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
