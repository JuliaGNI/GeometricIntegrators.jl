<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Splitting · GeometricIntegrators.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GeometricIntegrators.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../equations/">Equations</a></li><li><span class="tocitem">Integrators</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../rk/">Runge-Kutta</a></li><li class="is-active"><a class="tocitem" href>Splitting</a><ul class="internal"><li><a class="tocitem" href="#Splitting-Integrators"><span>Splitting Integrators</span></a></li><li><a class="tocitem" href="#Composition-Integrators"><span>Composition Integrators</span></a></li><li><a class="tocitem" href="#Splitting-of-Hamiltonian-Systems"><span>Splitting of Hamiltonian Systems</span></a></li><li><a class="tocitem" href="#Separable-Hamiltonian-Systems"><span>Separable Hamiltonian Systems</span></a></li><li><a class="tocitem" href="#Fourth-Order-Methods"><span>Fourth Order Methods</span></a></li><li><a class="tocitem" href="#Higher-Order-Methods-by-Composition"><span>Higher Order Methods by Composition</span></a></li><li><a class="tocitem" href="#Splitting-Tableaus"><span>Splitting Tableaus</span></a></li></ul></li><li><a class="tocitem" href="../variational/">Variational</a></li><li><a class="tocitem" href="../vprk/">VPRK</a></li><li><a class="tocitem" href="../spark/">SPARK</a></li><li><a class="tocitem" href="../cgvi/">CGVI</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../../modules/equations/">Equations</a></li><li><a class="tocitem" href="../../modules/integrators/">Integrators</a></li><li><a class="tocitem" href="../../modules/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../modules/simulations/">Simulations</a></li><li><a class="tocitem" href="../../modules/solutions/">Solutions</a></li></ul></li><li><span class="tocitem">Tableaus</span><ul><li><a class="tocitem" href="../../tableaus/rungekutta/">Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/rungekutta_partitioned/">Partitioned Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/splitting/">Splitting Methods</a></li><li><a class="tocitem" href="../../tableaus/vprk/">VPRK Methods</a></li><li><a class="tocitem" href="../../tableaus/spark/">SPARK Methods</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="../../developer/code_integration/">Code Integration</a></li><li><a class="tocitem" href="../../developer/custom_integrators/">Custom Integrators</a></li></ul></li><li><a class="tocitem" href="../../releasenotes/">Release Notes</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Integrators</a></li><li class="is-active"><a href>Splitting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Splitting</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl/blob/master/docs/src/integrators/splitting.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Splitting-and-Composition-Methods"><a class="docs-heading-anchor" href="#Splitting-and-Composition-Methods">Splitting and Composition Methods</a><a id="Splitting-and-Composition-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting-and-Composition-Methods" title="Permalink"></a></h1><p>GeometricIntegrators supports splitting and composition methods, where the solution to an ODE of the form</p><p class="math-container">\[\dot{x} = v_1 (t,x) + ... + v_r (t,x)\]</p><p>is obtained by consecutively integrating each vector field <span>$v_i$</span> independently and combining the resulting solutions in an appropriate way. Consider a simple ODE <span>$\dot{x} = V$</span> where the vector field <span>$v$</span> can be written as <span>$V = \sum_i v_i$</span>. The flow (exact solution) of this ODE is</p><p class="math-container">\[x(t) = \phi_{t} (x(0)) = \exp(t V) (x(0)) ,\]</p><p>and the composition method </p><p class="math-container">\[\varphi_{\tau} = \exp(\tau v_1) \exp(\tau v_2) \dotsc \exp(\tau v_r) ,\]</p><p>where <span>$\tau$</span> denotes the time step, provides a first-order accurate approximation to the exact flow as</p><p class="math-container">\[\phi_{\tau} = \exp \bigg( \tau \sum_i v_i \bigg) + \mathcal{O} (\tau^2) .\]</p><p>In the following, we use &quot;splitting methods&quot; to denote integrators that utilize the exact solution of each vector field <span>$v_i$</span> and &quot;composition methods&quot; to denote integrators that utilize some consistent but possibly approximate solution for each of the vector fields <span>$v_i$</span>, i.e., that solution can be exact or obtained by some other integrator. For reference see the excellent review paper by <a href="../../bibliography/#McLachlanQuispel:2002">Robert I. McLachlan , G. Reinout W. Quispel  (2002)</a> or the canonical book on Geometric Numerical Integration by <a href="../../bibliography/#HairerLubichWanner:2006">Ernst Hairer , Christian Lubich , Gerhard Wanner  (2006)</a>.</p><h2 id="Splitting-Integrators"><a class="docs-heading-anchor" href="#Splitting-Integrators">Splitting Integrators</a><a id="Splitting-Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting-Integrators" title="Permalink"></a></h2><p>In GeometricIntegrators, basic splitting methods are implemented in <a href="../../modules/integrators/#GeometricIntegrators.Integrators.IntegratorSplitting"><code>IntegratorSplitting</code></a>, which has two constructors:</p><pre><code class="language-julia">IntegratorSplitting{DT,D}(solutions::Tuple, f::Vector{Int}, c::Vector, Δt)
IntegratorSplitting(equation::SODE, tableau::AbstractTableauSplitting, Δt)</code></pre><p>In the first constructor, <code>DT</code> is the data type of the state vector and <code>D</code> the dimension of the system. In the second constructor, this information is extracted from the <code>equation</code>.  The tuple <code>solutions</code> contains functions implementing the flow (exact solution) of the vector fields <code>v_i</code>. The vectors <code>f</code> and <code>c</code> define the actual splitting method: <code>f</code> is a vector of indices of the flows in the split equation to be solved and <code>c</code> is a vector of the same size <code>f</code> that contains the coefficients for each splitting step, i.e., the resulting integrator has the form</p><p class="math-container">\[\varphi_{\tau} = \phi_{c[s] \tau}^{v_{f[s]}} \circ \dotsc \circ \phi_{c[2] \tau}^{v_{f[2]}} \circ \phi_{c[1] \tau}^{v_{f[1]}} .\]</p><p>In the second constructor, these vectors are constructed from the tableau and the equation.</p><h2 id="Composition-Integrators"><a class="docs-heading-anchor" href="#Composition-Integrators">Composition Integrators</a><a id="Composition-Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-Integrators" title="Permalink"></a></h2><p>Fully flexible composition methods are implemented in <a href="../../modules/integrators/#GeometricIntegrators.Integrators.IntegratorComposition"><code>IntegratorComposition</code></a>, which can use any ODE integrator implemented in GeometricIntegrators to solve the steps of the splitting. For each step, a different integrator can be chosen as well as the exact solution using <a href="../../modules/integrators/#GeometricIntegrators.Integrators.IntegratorExactODE"><code>IntegratorExactODE</code></a>, which is a simple wrapper around the exact flow of a splitting step, implementing the general integrator interface.</p><p><code>IntegratorComposition</code> has three constructors:</p><pre><code class="language-julia">IntegratorComposition{DT,D}(integrators::Tuple, Δt)
IntegratorComposition(equation::SODE, constructors::Tuple, tableau::AbstractTableauSplitting, Δt)
IntegratorComposition(equation::SODE, tableau::AbstractTableauSplitting, Δt)</code></pre><p>In the first constructor, <code>DT</code> is the data type of the state vector and <code>D</code> the dimension of the system. In the second and third constructor, this information is extracted from the equation.  The tuple <code>integrators</code> contains the integrators for each substep. Each integrator is instantiated with appropriately scaled time step size <span>$\Delta t = c_i \tau$</span> to match the corresponding splitting scheme. In the second constructor, the tuple <code>constructors</code> contains closures around the constructors for the integrators of each step of the composition, that is functions taking a vector field <span>$v_i$</span>, the time step <span>$\Delta t$</span> and optional keyword arguments, e.g. for the exact solution or a Runge-Kutta integrator, we have</p><pre><code class="language-julia">(v::Function, Δt::Number; kwargs...) -&gt; IntegratorExactODE{DT,D}(v, Δt; kwargs...)
(v::Function, Δt::Number; kwargs...) -&gt; Integrator{DT,D}(v, tableau, Δt; kwargs...)</code></pre><p>The integrators are constructed according to the tableau and time step <code>\Delta t</code> and passed to the first constructor. The third constructor assumes that the exact solution is used for each splitting step. It thus constructs a composition method that is equivalent to a plain <a href="../../modules/integrators/#GeometricIntegrators.Integrators.IntegratorSplitting"><code>IntegratorSplitting</code></a>.</p><h2 id="Splitting-of-Hamiltonian-Systems"><a class="docs-heading-anchor" href="#Splitting-of-Hamiltonian-Systems">Splitting of Hamiltonian Systems</a><a id="Splitting-of-Hamiltonian-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting-of-Hamiltonian-Systems" title="Permalink"></a></h2><p>For Hamiltonian systems, splitting is a simple and versatile technique for the construction of symplectic integrators. Suppose that the Hamiltonian <span>$H$</span> can be split into the sum of <span>$r \geq 2$</span> Hamiltonians <span>$H_{i}$</span> with <span>$1 \leq i \leq r$</span>, i.e.,</p><p class="math-container">\[H (z) = \sum \limits_{i=1}^{r} H_{i} (z) ,\]</p><p>with each Hamiltonian vector field</p><p class="math-container">\[\dot{z} = \Omega^{-T} \, \nabla H_{i} (z) \]</p><p>explicitly solvable. The exact solution <span>$\phi_{t}^{H_{i}}$</span> of each subsystem provides a symplectic map. As the composition of symplectic maps yields a symplectic map, a symplectic integrator can be obtained by an appropriate composition of the flow maps of each subsystem. A first-order symplectic integrator is obtained from the Lie-Trotter splitting,</p><p class="math-container">\[\varphi_{\tau} = \phi_{\tau}^{H_{1}} \circ \phi_{\tau}^{H_{2}} \circ \dotsc \circ \phi_{\tau}^{H_{k}} .\]</p><p>Second-order symplectic integrators are obtained from symmetric splittings,</p><p class="math-container">\[\varphi_{\tau} = \phi_{h/2}^{H_{1}} \circ \phi_{h/2}^{H_{2}} \circ \dotsc \circ \phi_{h/2}^{H_{k-1}} \circ \phi_{\tau}^{H_{k}} \circ \phi_{h/2}^{H_{k-1}} \circ \dotsc \circ \phi_{h/2}^{H_{2}} \circ \phi_{h/2}^{H_{1}} ,\]</p><p>or</p><p class="math-container">\[\varphi_{\tau} = \phi_{h/2}^{H_{k}} \circ \phi_{h/2}^{H_{k-1}} \circ \dotsc \circ \phi_{h/2}^{H_{2}} \circ \phi_{\tau}^{H_{1}} \circ \phi_{h/2}^{H_{2}} \circ \dotsc \circ \phi_{h/2}^{H_{k-1}} \circ \phi_{h/2}^{H_{k}} .\]</p><p>Higher order integrators can be constructed by using the Baker-Campbell-Hausdorff formula.</p><h2 id="Separable-Hamiltonian-Systems"><a class="docs-heading-anchor" href="#Separable-Hamiltonian-Systems">Separable Hamiltonian Systems</a><a id="Separable-Hamiltonian-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Separable-Hamiltonian-Systems" title="Permalink"></a></h2><p>If we have a Hamiltonian of the form <span>$H(p,q) = T(p) + U(q)$</span>, we can consider only the subsystem with Hamiltonian <span>$U(q)$</span>,</p><p class="math-container">\[\begin{aligned}
\dot{q} &amp;= 0 , &amp;
\dot{p} &amp;= - \nabla U(q) .
\end{aligned}\]</p><p>This system can be solved exactly. The exact flow is</p><p class="math-container">\[\phi^{U}_{t} (q,p) = \begin{pmatrix}
q \\
p - t \nabla U(q)
\end{pmatrix} .\]</p><p>Next, consider the subsystem with Hamiltonian <span>$T(p) = \tfrac{1}{2} p^T M^{-1} p$</span>, </p><p class="math-container">\[\begin{aligned}
\dot{q} &amp;= M^{-1} p , &amp;
\dot{p} &amp;= 0 . 
\end{aligned}\]</p><p>This system can be solved exactly as well. The exact flow is</p><p class="math-container">\[\phi^{T}_{t} (q,p) = \begin{pmatrix}
q + t M^{-1} p \\
p
\end{pmatrix} .\]</p><p>As <span>$\phi^{U}_{t}$</span> and <span>$\phi^{T}_{t}$</span> are exact flows of the respective Hamiltonian, they are both symplectic. We see that the compositions of <span>$\phi^{U}_{t}$</span> and <span>$\phi^{T}_{t}$</span> correspond to the symplectic Euler methods for separable Hamiltonians,</p><p class="math-container">\[\begin{aligned}
\varphi^{A}_{\tau} &amp;= \phi^{U}_{\tau} \circ \phi^{T}_{\tau} , &amp;
\varphi^{B}_{\tau} &amp;= \phi^{T}_{\tau} \circ \phi^{U}_{\tau} ,
\end{aligned}\]</p><p>where <span>$\varphi^{A}_{\tau}$</span> and <span>$\varphi^{B}_{\tau}$</span> denote the numerical flows of symplectic Euler-A and symplectic Euler-B, respectively. As the Störmer-Verlet methods are compositions of the symplectic Euler methods, they are also splitting methods, corresponding to the compositions</p><p class="math-container">\[\begin{aligned}
\varphi_{\tau}^{SV1} &amp;= \varphi^{A}_{h/2} \circ \varphi^{B}_{h/2} = \phi^{U}_{h/2} \circ \phi^{T}_{\tau} \circ \phi^{U}_{h/2} , \\
\varphi_{\tau}^{SV2} &amp;= \varphi^{B}_{h/2} \circ \varphi^{A}_{h/2} = \phi^{T}_{h/2} \circ \phi^{U}_{\tau} \circ \phi^{T}_{h/2} ,
\end{aligned}\]</p><p>respectively. This particular splitting is often referred to as <em>Strang splitting</em> [<a href="../../bibliography/#Strang:1968">Gilbert Strang  (1968)</a>, see also <a href="../../bibliography/#Marchuk:1968">Gurij Ivanovich Marchuk  (1968)</a>].</p><p>Let us note that not all symplectic integrators can be obtained as splitting methods. For the symplectic Euler methods and the Störmer-Verlet methods, this is only possible for separable Hamiltonian systems. For general Hamiltonians, these methods cannot be obtained from any splitting but are nevertheless symplectic.</p><h2 id="Fourth-Order-Methods"><a class="docs-heading-anchor" href="#Fourth-Order-Methods">Fourth Order Methods</a><a id="Fourth-Order-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Fourth-Order-Methods" title="Permalink"></a></h2><p>The general form of a fourth order symplectic integrator for separable Hamiltonian systems is given by</p><p class="math-container">\[\begin{aligned}
q_{1} &amp;= q_{0} + b_{1} \tau \, T_{p} (p_{0}) , &amp;
p_{1} &amp;= p_{0} - \hat{b}_{1} \tau \, U_{q} (q_{1}) , \\
q_{2} &amp;= q_{1} + b_{2} \tau \, T_{p} (p_{1}) , &amp;
p_{2} &amp;= p_{1} - \hat{b}_{2} \tau \, U_{q} (q_{2}) , \\
q_{3} &amp;= q_{2} + b_{3} \tau \, T_{p} (p_{2}) , &amp;
p_{3} &amp;= p_{2} - \hat{b}_{3} \tau \, U_{q} (q_{3}) , \\
q_{4} &amp;= q_{3} + b_{4} \tau \, T_{p} (p_{3}) , &amp;
p_{4} &amp;= p_{3} - \hat{b}_{4} \tau \, U_{q} (q_{4}) .
\end{aligned}\]</p><p>The quantities <span>$(q_{0}, p_{0})$</span> are initial values and <span>$(q_{4}, p_{4})$</span> are the numerical solution after one time step <span>$\tau$</span>. The whole algorithm can be written as</p><p class="math-container">\[\begin{aligned}
\varphi_{\tau} &amp;= 
\varphi_{\hat{b}_{4} \tau}^{U}
\circ
\varphi_{b_{4} \tau}^{T}
\circ
\varphi_{\hat{b}_{3} \tau}^{U}
\circ
\varphi_{b_{3} \tau}^{T}
\circ
\varphi_{\hat{b}_{2} \tau}^{U}
\circ
\varphi_{b_{2} \tau}^{T}
\circ
\varphi_{\hat{b}_{1} \tau}^{U}
\circ
\varphi_{b_{1} \tau}^{T}
\end{aligned}\]</p><p>and is therefore immediately seen to be symplectic. Two methods of fourth order are given by</p><p class="math-container">\[\begin{aligned}
b_{1} &amp;= b_{4} = \dfrac{1}{2 (2 - \gamma)} , &amp;
b_{2} &amp;= b_{3} = \dfrac{1-\gamma}{2 (2 - \gamma)} , \\
\hat{b}_{1} &amp;= \hat{b}_{3} = \dfrac{1}{2 - \gamma} , &amp;
\hat{b}_{2} &amp;= - \dfrac{\gamma}{2 - \gamma} , &amp;
\hat{b}_{4} &amp;= 0 ,
\end{aligned}\]</p><p>and</p><p class="math-container">\[\begin{aligned}
b_{1} &amp;= 0 , &amp;
b_{2} &amp;= b_{4} = \dfrac{1}{2 - \gamma} , &amp;
b_{3} &amp;= \dfrac{1}{1 - \gamma^{2}} , \\
\hat{b}_{1} &amp;= \hat{b}_{4} = \tfrac{1}{6} (2 + \gamma + \gamma^{-1}) , &amp;
\hat{b}_{2} &amp;= \hat{b}_{3} = \tfrac{1}{6} (2 - \gamma - \gamma^{-1}) ,
\end{aligned}\]</p><p>where <span>$\gamma = 2^{1/3}$</span>. Both methods are explicit and symmetric as either <span>$\varphi_{\hat{b}_{4} \tau}^{U}$</span> or <span>$\varphi_{b_{1} \tau}^{T}$</span> corresponds to the identity.</p><h2 id="Higher-Order-Methods-by-Composition"><a class="docs-heading-anchor" href="#Higher-Order-Methods-by-Composition">Higher Order Methods by Composition</a><a id="Higher-Order-Methods-by-Composition-1"></a><a class="docs-heading-anchor-permalink" href="#Higher-Order-Methods-by-Composition" title="Permalink"></a></h2><p>The composition of a one-step symplectic integrator <span>$\varphi_{\tau}$</span> with different step sizes provides a simple way of obtaining higher order schemes. We assume that the initial scheme <span>$\varphi_{\tau}$</span> is symmetric, that is</p><p class="math-container">\[\varphi_{\tau} \circ \varphi_{-\tau} = \mathrm{id} ,\]</p><p>as this simplifies the construction. A symmetric method can always be built by combining a non-symmetric method with its adjoint. If a numerical method <span>$\varphi_{\tau}$</span> is symmetric, it can be used to compose higher order methods by splitting up each timestep into <span>$s$</span> substeps [<a href="../../bibliography/#HairerLubichWanner:2006">Ernst Hairer , Christian Lubich , Gerhard Wanner  (2006)</a>, <a href="../../bibliography/#McLachlan:1995">Robert I. McLachlan  (1995)</a>, <a href="../../bibliography/#MarsdenWest:2001">Jerrold E. Marsden , Matthew West  (2001)</a>],</p><p class="math-container">\[\varphi_{\tau} = \varphi_{\gamma_{s} \tau} \circ ... \circ \varphi_{\gamma_{i} \tau} \circ ... \circ \varphi_{\gamma_{1} \tau} ,\]</p><p>where the careful selection of the <span>$\gamma_{i}$</span> is crucial for the performance of the resulting scheme. In the following, we present some fourth and sixth order composition methods that can be applied in most situations.</p><h4 id="Fourth-Order-Composition-Methods"><a class="docs-heading-anchor" href="#Fourth-Order-Composition-Methods">Fourth Order Composition Methods</a><a id="Fourth-Order-Composition-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Fourth-Order-Composition-Methods" title="Permalink"></a></h4><p>If <span>$\varphi_{\tau}$</span> is a method of order <span>$r$</span>, a method <span>$\hat{\varphi}_{\tau}$</span> of order <span>$r+2$</span> is obtained by the composition [<a href="../../bibliography/#HairerLubichWanner:2006">Ernst Hairer , Christian Lubich , Gerhard Wanner  (2006)</a>, Section V.3.2]</p><p class="math-container">\[\begin{aligned}
\hat{\varphi}_{\tau} &amp;= \varphi_{\gamma \tau} \circ \varphi_{(1-2\gamma) \tau} \circ \varphi_{\gamma \tau} &amp;
&amp; \text{with} &amp;
\gamma &amp;= (2 - 2^{1/(r+1)})^{-1} . &amp;
\end{aligned}\]</p><p>Hence, if <span>$\varphi_{\tau}$</span> is of second order, the resulting method <span>$\hat{\varphi}_{\tau}$</span> will be of fourth order. Note that symmetric methods are always of even order. A method of the same order but with generally smaller errors is obtained by considering five steps</p><p class="math-container">\[\begin{aligned}
\hat{\varphi}_{\tau} &amp;= \varphi_{\gamma \tau} \circ \varphi_{\gamma \tau} \circ \varphi_{(1-4\gamma) \tau} \circ \varphi_{\gamma \tau} \circ \varphi_{\gamma \tau} &amp;
&amp; \text{with} &amp;
\gamma &amp;= (4 - 4^{1/(r+1)})^{-1} . &amp;
\end{aligned}\]</p><p>Multiple application of these compositions yields methods of orders higher than four.</p><h4 id="Sixth-Order-Composition-Methods"><a class="docs-heading-anchor" href="#Sixth-Order-Composition-Methods">Sixth Order Composition Methods</a><a id="Sixth-Order-Composition-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Sixth-Order-Composition-Methods" title="Permalink"></a></h4><p>Higher order compositions can also be constructed directly [<a href="../../bibliography/#HairerLubichWanner:2006">Ernst Hairer , Christian Lubich , Gerhard Wanner  (2006)</a>, Section V.3.2]. A sixth order method with seven substeps is given by</p><p class="math-container">\[\begin{aligned}
\gamma_{1} = \gamma_{7} &amp;= + 0.78451361047755726381949763 , \\
\gamma_{2} = \gamma_{6} &amp;= + 0.23557321335935813368479318 , \\
\gamma_{3} = \gamma_{5} &amp;= - 1.17767998417887100694641568 , \\
\gamma_{4} &amp;= + 1.31518632068391121888424973 ,
\end{aligned}\]</p><p>but again smaller errors can be achieved by using nine steps</p><p class="math-container">\[\begin{aligned}
\gamma_{1} = \gamma_{9} &amp;= + 0.39216144400731413927925056 , \\
\gamma_{2} = \gamma_{8} &amp;= + 0.33259913678935943859974864 , \\
\gamma_{3} = \gamma_{7} &amp;= - 0.70624617255763935980996482 , \\
\gamma_{4} = \gamma_{6} &amp;= + 0.08221359629355080023149045 , \\
\gamma_{5} &amp;= + 0.79854399093482996339895035 .
\end{aligned}\]</p><p>The computational effort of these high order methods is quite large. Each step requires the solution of a nonlinear system of equations. Given the outstanding performance already second order symplectic integrators are able to deliver, the necessity for such high order methods is rarely found. Nevertheless, if extremely high accuracy is indispensable, think for example of long-time simulations of the solar system, these methods can be applied. Moreover, there exist special methods optimized for such problems.</p><h2 id="Splitting-Tableaus"><a class="docs-heading-anchor" href="#Splitting-Tableaus">Splitting Tableaus</a><a id="Splitting-Tableaus-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting-Tableaus" title="Permalink"></a></h2><p>Actualy splitting methods are usually prescribed in one of the following forms.</p><h3 id="[TableauSplitting](@ref)"><a class="docs-heading-anchor" href="#[TableauSplitting](@ref)"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.TableauSplitting"><code>TableauSplitting</code></a></a><a id="[TableauSplitting](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TableauSplitting](@ref)" title="Permalink"></a></h3><p>Tableau for general splitting methods for vector fields with two terms <span>$v = v_A + v_B$</span>, leading to the following integrator:</p><p class="math-container">\[\varphi_{\tau} = \varphi_{b_s \tau}^{B} \circ \varphi_{a_s \tau}^{A} \circ \dotsc \circ \varphi_{b_1 \tau}^{B} \circ \varphi_{a_1 \tau}^{A} .\]</p><h3 id="[TableauSplittingNS](@ref)"><a class="docs-heading-anchor" href="#[TableauSplittingNS](@ref)"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.TableauSplittingNS"><code>TableauSplittingNS</code></a></a><a id="[TableauSplittingNS](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TableauSplittingNS](@ref)" title="Permalink"></a></h3><p>Tableau for non-symmetric splitting methods [<a href="../../bibliography/#McLachlanQuispel:2002">Robert I. McLachlan , G. Reinout W. Quispel  (2002)</a>, Equation (4.10)]. Here, two flows <span>$\varphi_{\tau}^{A}$</span> and <span>$\varphi_{\tau}^{B}$</span> are constructed as the Lie composition of all vector fields in the SODE and its adjoint, respectively, i.e..</p><p class="math-container">\[\begin{aligned}
\varphi_{\tau}^{A} &amp;= \varphi_{\tau}^{v_1} \circ \varphi_{\tau}^{v_2} \circ \dotsc \circ \varphi_{\tau}^{v_{r-1}} \circ \varphi_{\tau}^{v_r} , \\
\varphi_{\tau}^{B} &amp;= \varphi_{\tau}^{v_r} \circ \varphi_{\tau}^{v_{r-1}} \circ \dotsc \circ \varphi_{\tau}^{v_2} \circ \varphi_{\tau}^{v_1} ,
\end{aligned}\]</p><p>and the integrator is composed as follows:</p><p class="math-container">\[\varphi_{\tau}^{NS} = \varphi_{b_s \tau}^{B} \circ \varphi_{a_s \tau}^{A} \circ \dotsc \circ \varphi_{b_1 \tau}^{B} \circ \varphi_{a_1 \tau}^{A} .\]</p><h3 id="[TableauSplittingGS](@ref)"><a class="docs-heading-anchor" href="#[TableauSplittingGS](@ref)"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.TableauSplittingGS"><code>TableauSplittingGS</code></a></a><a id="[TableauSplittingGS](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TableauSplittingGS](@ref)" title="Permalink"></a></h3><p>Tableau for symmetric splitting methods with general stages [<a href="../../bibliography/#McLachlanQuispel:2002">Robert I. McLachlan , G. Reinout W. Quispel  (2002)</a>, Equation (4.11)], where again two flows <span>$\varphi_{\tau}^{A}$</span> and <span>$\varphi_{\tau}^{B}$</span> are constructed via Lie composition</p><p class="math-container">\[\begin{aligned}
\varphi_{\tau}^{A} &amp;= \varphi_{\tau}^{v_1} \circ \varphi_{\tau}^{v_2} \circ \dotsc \circ \varphi_{\tau}^{v_{r-1}} \circ \varphi_{\tau}^{v_r} , \\
\varphi_{\tau}^{B} &amp;= \varphi_{\tau}^{v_r} \circ \varphi_{\tau}^{v_{r-1}} \circ \dotsc \circ \varphi_{\tau}^{v_2} \circ \varphi_{\tau}^{v_1} ,
\end{aligned}\]</p><p>but with an integrator composed as</p><p class="math-container">\[\varphi_{\tau}^{GS} = \varphi_{a_1 \tau}^{A} \circ \varphi_{b_1 \tau}^{B} \circ \dotsc \circ \varphi_{b_1 \tau}^{B} \circ \varphi_{a_1 \tau}^{A} .\]</p><h3 id="[TableauSplittingSS](@ref)"><a class="docs-heading-anchor" href="#[TableauSplittingSS](@ref)"><a href="../../modules/integrators/#GeometricIntegrators.Integrators.TableauSplittingSS"><code>TableauSplittingSS</code></a></a><a id="[TableauSplittingSS](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TableauSplittingSS](@ref)" title="Permalink"></a></h3><p>Tableau for symmetric splitting methods with symmetric stages [<a href="../../bibliography/#McLachlanQuispel:2002">Robert I. McLachlan , G. Reinout W. Quispel  (2002)</a>, Equation (4.6)]. Here, only one flow <span>$\varphi_{\tau}^{S}$</span> is constructed via symmetric Strang composition,</p><p class="math-container">\[\varphi_{\tau}^{S} = \varphi_{\tau/2}^{v_1} \circ \varphi_{\tau/2}^{v_2} \circ \dotsc \circ \varphi_{\tau/2}^{v_{r-1}} \circ \varphi_{\tau/2}^{v_r} \circ \varphi_{\tau/2}^{v_r} \circ \varphi_{\tau/2}^{v_{r-1}} \circ \dotsc \circ \varphi_{\tau/2}^{v_2} \circ \varphi_{\tau/2}^{v_1} ,\]</p><p>and composed as</p><p class="math-container">\[\varphi_{\tau}^{SS} = \varphi_{a_1 \tau}^{S} \circ \varphi_{a_2 \tau}^{S} \circ \dotsc \circ \varphi_{a_s \tau}^{S} \circ \dotsc \circ \varphi_{a_2 \tau}^{S} \circ \varphi_{a_1 \tau}^{S} ,\]</p><p>to obtain an integrator.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rk/">« Runge-Kutta</a><a class="docs-footer-nextpage" href="../variational/">Variational »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 4 March 2021 20:41">Thursday 4 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
