<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Variational · GeometricIntegrators.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GeometricIntegrators.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../equations/">Equations</a></li><li><span class="tocitem">Integrators</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../rk/">Runge-Kutta</a></li><li><a class="tocitem" href="../splitting/">Splitting</a></li><li class="is-active"><a class="tocitem" href>Variational</a><ul class="internal"><li><a class="tocitem" href="#Discretisation-of-the-Action"><span>Discretisation of the Action</span></a></li><li><a class="tocitem" href="#Discrete-Euler-Lagrange-Equations"><span>Discrete Euler-Lagrange Equations</span></a></li><li><a class="tocitem" href="#Discrete-Fibre-Derivative"><span>Discrete Fibre Derivative</span></a></li><li><a class="tocitem" href="#Discrete-Symplectic-Form"><span>Discrete Symplectic Form</span></a></li><li><a class="tocitem" href="#Discrete-Noether-Theorem"><span>Discrete Noether Theorem</span></a></li></ul></li><li><a class="tocitem" href="../vprk/">VPRK</a></li><li><a class="tocitem" href="../spark/">SPARK</a></li><li><a class="tocitem" href="../cgvi/">CGVI</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../../modules/equations/">Equations</a></li><li><a class="tocitem" href="../../modules/integrators/">Integrators</a></li><li><a class="tocitem" href="../../modules/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../modules/simulations/">Simulations</a></li><li><a class="tocitem" href="../../modules/solutions/">Solutions</a></li></ul></li><li><span class="tocitem">Tableaus</span><ul><li><a class="tocitem" href="../../tableaus/rungekutta/">Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/rungekutta_partitioned/">Partitioned Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/splitting/">Splitting Methods</a></li><li><a class="tocitem" href="../../tableaus/vprk/">VPRK Methods</a></li><li><a class="tocitem" href="../../tableaus/spark/">SPARK Methods</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="../../developer/code_integration/">Code Integration</a></li><li><a class="tocitem" href="../../developer/custom_integrators/">Custom Integrators</a></li></ul></li><li><a class="tocitem" href="../../releasenotes/">Release Notes</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Integrators</a></li><li class="is-active"><a href>Variational</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Variational</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl/blob/master/docs/src/integrators/variational.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="variational-integrators"><a class="docs-heading-anchor" href="#variational-integrators">Variational Integrators</a><a id="variational-integrators-1"></a><a class="docs-heading-anchor-permalink" href="#variational-integrators" title="Permalink"></a></h1><p>The basic idea of variational integrators is to construct a discrete counterpart to a particular mechanical system instead of directly discretising its equations of motion. This means that the fundamental building blocks of classical mechanics, namely the action functional, the Lagrangian, the variational principle, and the Noether theorem, all have discrete equivalents. The application of the discrete variational principle to the discrete action then leads to discrete Euler-Lagrange equations. The evolution map that corresponds to the discrete Euler-Lagrange equations is what is called a variational integrator. The discrete Noether theorem can be used to relate symmetries of the discretised system to discrete momenta that are in principle exactly preserved by this integrator.</p><p>With standard numerical methods, one approximately solves the exact equations of some system. In a sense, the idea of variational integrators is to exactly solve the equations of an approximate system.</p><p>The seminal work in the development of a discrete equivalent of classical mechanics was presented by [<a href="../../bibliography/#Veselov:1988">Alexander P. Veselov  (1988)</a>, <a href="../../bibliography/#Veselov:1988">Alexander P. Veselov  (1988)</a>]. His method, based on a discrete variational principle, leads to symplectic integration schemes that automatically preserve constants of motion [<a href="../../bibliography/#WendlandtMarsden:1997">Jeffrey M. Wendlandt , Jerrold E. Marsden  (1997)</a>, <a href="../../bibliography/#MarsdenWendlandt:1997">Jerrold E. Marsden , Jeffrey M. Wendlandt  (1997)</a>]. A comprehensive review of discrete mechanics can be found in [<a href="../../bibliography/#MarsdenWest:2001">Jerrold E. Marsden , Matthew West  (2001)</a>], including a thorough account on the historical development. The discrete version of Hamilton&#39;s phasespace action principle is presented in [<a href="../../bibliography/#Leok:2011">Melvin Leok , Jingjing Zhang  (2011)</a>].</p><h2 id="Discretisation-of-the-Action"><a class="docs-heading-anchor" href="#Discretisation-of-the-Action">Discretisation of the Action</a><a id="Discretisation-of-the-Action-1"></a><a class="docs-heading-anchor-permalink" href="#Discretisation-of-the-Action" title="Permalink"></a></h2><p>The derivation of the discrete theory follows along the lines of the derivation of the continuous theory. The starting point is the discretisation of the space of paths <span>$\mathcal{Q} ( \mf{M} )$</span> that connect two points in <span>$\mf{M}$</span>,</p><p class="math-container">\[\mathcal{Q} ( \mf{M} ) = \big\{ q : \mathcal{I} \rightarrow \mf{M} \; \big\vert \; \mathcal{I} \subset \mathbb{R} \; \text{smooth and bounded} \big\} .\]</p><p>Therefore we divide each time interval <span>$\mathcal{I}$</span> into an equidistant, monotonic sequence <span>$\{ t_{n} \}_{n=0}^{N}$</span> and defined the discrete path space as</p><p class="math-container">\[\mathcal{Q}_{d} ( \mf{M} ) = \big\{ q_{d} : \{ t_{n} \}_{n=0}^{N} \rightarrow \mf{M} \big\} .\]</p><p>The space <span>$\mathcal{Q}_{d} ( \mf{M} )$</span> contains all possible discrete trajectories <span>$q_{d}$</span> in <span>$\mf{M}$</span> and is isomorphic to <span>$\mf{M} \times ... \times \mf{M}$</span> (<span>$N+1$</span> copies),</p><p class="math-container">\[\mathcal{Q}_{d} ( \mf{M} ) \cong \bigtimes_{N+1} \mf{M} .\]</p><p>Therefore <span>$\mathcal{Q}_{d} ( \mf{M} )$</span> constitutes a finite-dimensional approximation of the infinite-dimensional space <span>$\mathcal{Q} ( \mf{M} )$</span>. Note that <span>$\mathcal{Q}_{d}$</span> is not a subspace of <span>$\mathcal{Q}$</span>. Fixing an interval <span>$[0, T]$</span>, so that</p><p class="math-container">\[\{ t_{n} \}_{n=0}^{N} = \{ t_{n} = nh \; \vert \; n = 0, ..., N , \; Nh = T \} \subset \mathbb{R} ,\]</p><p>is an increasing sequence of time points and <span>$h$</span> is the discrete time step, the discrete equivalent of the space of curves from <span>$q_{0}$</span> to <span>$q_{N}$</span>,</p><p class="math-container">\[\mathcal{Q} ( q_{0}, q_{N}, [0, T] ) = \big\{ q : [0, T] \rightarrow \mf{M} \; \big\vert \; q(0) = q_{0}, \, q(T) = q_{N} \big\} \subset \mathcal{Q} ( \mf{M} ) ,\]</p><p>is the space that contains all discrete trajectories with fixed endpoints <span>$q_{0}$</span> and <span>$q_{N}$</span>, defined as</p><p class="math-container">\[\mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} ) = \big\{ q_{d} : \{ t_{n} \}_{n=0}^{N} \rightarrow \mf{M} \; \big\vert \; q(t_{0}) = q_{0}, q(t_{N}) = q_{N} \big\} \subset \mathcal{Q}_{d} ( \mf{M} ) .\]</p><p>The discrete trajectory can be written as <span>$q_{d} = \{ q_{n} \}_{n=0}^{N}$</span>, where <span>$q_{n}$</span> denotes the generalised coordinates at time <span>$t_{n}$</span>. The space <span>$\mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} )$</span> is a finite-dimensional approximation of <span>$\mathcal{Q} ( q_{0}, q_{N}, [0, T] )$</span>. In the following, we will use piecewise linear Lagrange polynomials to approximate the trajectory <span>$q(t)$</span>, that is</p><p class="math-container">\[\begin{equation}\label{eq:vi-linear-interpolation}
q_{h} (t) \big\vert_{[t_{n}, t_{n+1}]} = q_{n} \dfrac{t_{n+1} - t}{t_{n+1} - t_{n}} + q_{n+1} \dfrac{t - t_{n}}{t_{n+1} - t_{n}} .
\end{equation}\]</p><p>The next step is to choose a quadrature rule which determines the discrete action. While the continuous action is a map</p><p class="math-container">\[\mathcal{A} : \mathcal{Q} ( q_{0}, q_{N}, [0, T] ) \rightarrow \mathbb{R} ,\]</p><p>assigning real values to each path <span>$q(t)$</span>, the discrete action is a map</p><p class="math-container">\[\mathcal{A}_{d} : \mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} ) \rightarrow \mathbb{R} ,\]</p><p>assigning real values to each discrete path <span>$q_{d}$</span>. Once we obtained the discrete action, everything else follows in a straight forward and systematic way from Hamilton&#39;s principle of stationary action, so that these choices are determining the form of the discrete equations of motion.</p><p>After we fix the sequence <span>$\{ t_{n} \}_{n=0}^{N}$</span>, the continuous action can be written as</p><p class="math-container">\[\mathcal{A} [q(t)] = {\sum}_{n=0}^{N-1} \int_{t_{n}}^{t_{n+1}} L (q, \dot{q}) \, dt .\]</p><p>The terms of the sum are called the \emph{exact discrete Lagrangian},</p><p class="math-container">\[L_{d}^{\mathrm{e}} (q_{n}, q_{n+1}) = \int_{t_{n}}^{t_{n+1}} L \big( q_{n,n+1} (t), \, \dot{q}_{n,n+1} (t) \big) \, dt ,\]</p><p>which is defined as a function of two consecutive points on the discrete trajectory <span>$q_{d} = \{ q_{n} \}_{n=0}^{N}$</span>. Here, <span>$q_{n,n+1} (t)$</span> denotes the solution of the continuous Euler-Lagrange equations in the interval <span>$[t_{n}, t_{n+1}]$</span>  satisfying the boundary conditions <span>$q_{n,n+1} (t_{n}) = q_{n}$</span> and <span>$q_{n,n+1} (t_{n+1}) = q_{n+1}$</span>, with <span>$q_{n}$</span> denoting the generalised coordinates at time <span>$t_{n}$</span> and <span>$\dot{q}_{n}$</span> the generalised velocities at time point <span>$t_{n}$</span>. In practice, the exact discrete Lagrangian cannot be computed exactly, which means we have to approximate it,</p><p class="math-container">\[L_{d} (q_{n}, q_{n+1}) \approx \int_{t_{n}}^{t_{n+1}} L \big( q_{n,n+1} (t), \, \dot{q}_{n,n+1} (t) \big) \, dt .\]</p><p>That is, we have to approximate the trajectory <span>$q(t)$</span>, the velocity <span>$\dot{q}(t)$</span> and the integral. This approximation leads to the discrete Lagrangian, given as</p><p class="math-container">\[\begin{equation}\label{eq:vi-quadrature}
L_{d} (q_{n}, q_{n+1}) = h \sum \limits_{i=1}^{s} b_{i} \, L \big( q_{h} (t_{n} + c_{i} h), \, \dot{q}_{h} (t_{n} + c_{i} h) \big) ,
\end{equation}\]</p><p>where <span>$q_{n} = q_{h} (t_{n})$</span> and <span>$q_{n+1} = q_{h} (t_{n+1})$</span>. The discrete action thus becomes merely a sum over the time index of discrete Lagrangians</p><p class="math-container">\[\begin{equation}\label{eq:vi-action}
\mathcal{A}_{d} [q_{d}] = \sum \limits_{n=0}^{N-1} L_{d} (q_{n}, q_{n+1}) ,
\end{equation}\]</p><p>which defines a map <span>$\mathcal{A}_{d} : \mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} ) \rightarrow \mathbb{R}$</span>. In order to obtain the discrete Lagrangian, the generalised velocities are often discretised by simple finite-difference expressions\footnote{ In the first term of the trapezoidal rule \eqref{eq:vi-trapezoidal}, this corresponds to a forward finite-difference, in the second term to a backward finite-difference, and in the midpoint rule \eqref{eq:vi-midpoint} to a centred finite-difference. }, i.e.,</p><p class="math-container">\[\dot{q} (t) \approx \dfrac{q_{n+1} - q_{n}}{h}
\hspace{3em} \text{for} \hspace{3em}
t \in [ t_{n} , t_{n+1} ] . \]</p><p>This corresponds to approximating the trajectory <span>$q(t)$</span> between <span>$t_{n}$</span> and <span>$t_{n+1}$</span> by linear interpolation between <span>$q_{n}$</span> and <span>$q_{n+1}$</span> like in \eqref{eq:vi-linear-interpolation} and taking the derivative of <span>$q_{h} (t)$</span> with respect to <span>$t$</span>. The quadrature is most often realised by either the trapezoidal rule (<span>$c_{1} = 0$</span>, <span>$c_{2} = 1$</span>),</p><p class="math-container">\[\begin{equation}\label{eq:vi-trapezoidal}
L_{d}^{\text{tr}} (q_{n}, q_{n+1}) = \dfrac{h}{2} \, L \bigg( q_{n}, \dfrac{q_{n+1} - q_{n}}{h} \bigg) + \dfrac{h}{2} \, L \bigg( q_{n+1}, \dfrac{q_{n+1} - q_{n}}{h} \bigg) ,
\end{equation}\]</p><p>or the midpoint rule (<span>$c_{1} = 1/2$</span>),</p><p class="math-container">\[\begin{equation}\label{eq:vi-midpoint}
L_{d}^{\text{mp}} (q_{n}, q_{n+1}) = h \, L \bigg( \dfrac{q_{n} + q_{n+1}}{2}, \dfrac{q_{n+1} - q_{n}}{h} \bigg) .
\end{equation}\]</p><p>The configuration manifold of the discrete theory is still <span>$\mf{M}$</span>, but the discrete state space is <span>$\mf{M} \times \mf{M}$</span> instead of <span>$\tb{\mf{M}}$</span>, such that the discrete Lagrangian <span>$L_{d}$</span> is a function</p><p class="math-container">\[\begin{equation}\label{eq:vi-discrete_lagrangian}
L_{d} : \mf{M} \times \mf{M} \rightarrow \mathbb{R} ,
\end{equation}\]</p><p>mapping two points on the discrete trajectory into the real numbers.</p><h2 id="Discrete-Euler-Lagrange-Equations"><a class="docs-heading-anchor" href="#Discrete-Euler-Lagrange-Equations">Discrete Euler-Lagrange Equations</a><a id="Discrete-Euler-Lagrange-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Euler-Lagrange-Equations" title="Permalink"></a></h2><p><img src="../images/variation-discrete.png" alt="Variations of the discrete trajectory"/></p><p>The discrete trajectories <span>$q_{d} = \{ q_{n} \}_{n=0}^{N}$</span> are required to satisfy a discrete version of Hamilton&#39;s principle of stationary action</p><p class="math-container">\[\delta \mathcal{A}_{d} [q_{d}] = \delta \sum \limits_{n=0}^{N-1} L_{d} (q_{n}, q_{n+1}) = 0 .\]</p><p>As each point <span>$q_{n}$</span> of the discrete trajectory takes continuous values, we consider variations as as one-parameter families of transformations, that is families of paths <span>$q_{d}^{\epsilon} = \{ q_{n}^{\epsilon} \}_{n=0}^{N} \in \mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} )$</span> which contain the solution path <span>$q_{d}$</span> for <span>$\epsilon=0$</span>. The variations of <span>$q_{d}$</span> are contained in the tangent space <span>$\tb[q_{d}]{\mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} )}$</span> to <span>$\mathcal{Q}_{d} ( q_{0}, q_{N}, \{ t_{n} \}_{n=0}^{N} )$</span> at <span>$q_{d}$</span>. It is defined as the set of maps</p><p class="math-container">\[\begin{aligned}
v_{q_{d}} : \{ t_{n} \}_{n=0}^{N} &amp;\rightarrow \tb{\mf{M}} &amp;
&amp; \text{such that} &amp;
\pi_{\mf{M}} \circ v_{q_{d}} &amp;= q_{d} &amp;
&amp; \text{and} &amp;
v (t_{0}) = v (t_{N}) &amp;= 0 ,
\end{aligned}\]</p><p>where <span>$\pi_{\mf{M}}$</span> is the canonical projection <span>$\pi_{\mf{M}} : \tb{\mf{M}} \rightarrow \mf{M}$</span> and local coordinates are given by</p><p class="math-container">\[v_{q_{d}} = \{ (q_{n}, v_{n}) \}_{n=0}^{N} .\]</p><p>In particular, a discrete variation <span>$v_{q_{d}}$</span> of the discrete path <span>$q_{d}$</span> is defined as</p><p class="math-container">\[v_{q_{d}} = \dfrac{d}{d\epsilon} q_{d}^{\epsilon} \bigg\vert_{\epsilon=0} .\]</p><p>By identifying <span>$\delta \equiv d / d\epsilon \big\vert_{\epsilon=0}$</span>, we can also denote the variation by <span>$v_{q_{d}} = \delta q_{d}$</span>. In analogy to the continuous setting, the variation of the discrete action can be written as</p><p class="math-container">\[\delta \mathcal{A}_{d} [q_{d}] = 
\dfrac{d}{d\epsilon} \mathcal{A}_{d} [q_{d}^{\epsilon}] \bigg\vert_{\epsilon=0}
= \ext \mathcal{A}_{d} [q_{d}] \cdot v_{q_{d}} ,\]</p><p>which explicitly computed becomes</p><p class="math-container">\[\begin{equation}\label{eq:vi-variation_01}
\ext \mathcal{A}_{d} [q_{d}] \cdot v_{q_{d}} = \sum \limits_{n=0}^{N-1} \big[ D_{1} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n} + D_{2} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n+1} \big] ,
\end{equation}\]</p><p>where <span>$D_{i}$</span> denotes the derivative with respect to to the <span>$i$</span>th argument (slot derivative). What follows corresponds to a discrete integration by parts, i.e., a reordering of the summation. The <span>$n=0$</span> term is separated from the first part of the sum and the <span>$n=N-1$</span> term is separated from the second part</p><p class="math-container">\[\begin{equation}\label{eq:vi-variation_02}
\begin{aligned}
\ext \mathcal{A}_{d} [q_{d}] \cdot v_{q_{d}}
\nonumber
 = D_{1} \, L_{d} (q_{0}, q_{1}) \cdot v_{0}
&amp;+ \sum \limits_{n=1}^{N-1} D_{1} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n} \\
&amp;+ \sum \limits_{n=0}^{N-2} D_{2} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n+1}
 + D_{2} \, L_{d} (q_{N-1}, q_{N}) \cdot v_{N}
.
\end{aligned}
\end{equation}\]</p><p>As the variations at the endpoints are kept fixed, <span>$v_{0} = v (t_{0}) = 0$</span> as well as <span>$v_{N} = v (t_{N}) = 0$</span>, the corresponding terms vanish. At last, the summation range of the second sum is shifted upwards by one with the arguments of the discrete Lagrangian adapted correspondingly</p><p class="math-container">\[\begin{equation}\label{eq:vi-variation_03}
\ext \mathcal{A}_{d} [q_{d}] \cdot v_{q_{d}}
=  \sum \limits_{n=1}^{N-1} \big[ D_{1} \, L_{d} (q_{n}, q_{n+1}) + D_{2} \, L_{d} (q_{n-1}, q_{n}) \big] \cdot v_{n}
.
\end{equation}\]</p><p>Hamilton&#39;s principle of least action requires the variation of the discrete action <span>$\delta \mathcal{A}_{d}$</span> to vanish for any choice of <span>$v_{n}$</span>. Consequently, the expression in the square brackets has to vanish. This defines the discrete Euler-Lagrange equations</p><p class="math-container">\[\begin{equation}\label{eq:vi-deleqs}
D_{1} \, L_{d} (q_{n}, q_{n+1}) + D_{2} \, L_{d} (q_{n-1}, q_{n}) = 0
\end{equation}\]</p><p>The discrete Euler-Lagrange equations define an evolution map</p><p class="math-container">\[\begin{equation}\label{eq:vi-evolution_map}
\varphi_{h}
\; : \; \mf{M} \times \mf{M} \rightarrow \mf{M} \times \mf{M}
\; : \; ( q_{n-1}, q_{n} ) \mapsto ( q_{n}, q_{n+1} ) .
\end{equation}\]</p><p>Starting from two configurations, <span>$q_{0} \approx q (t_{0})$</span> and <span>$q_{1} \approx q (t_{1} = t_{0} + h)$</span>, the successive solution of the discrete Euler-Lagrange equations for <span>$q_{2}$</span>, <span>$q_{3}$</span>, etc., up to <span>$q_{N}$</span>, determines the discrete trajectory <span>$\{ q_{n} \}_{n=0}^{N}$</span>.</p><h2 id="Discrete-Fibre-Derivative"><a class="docs-heading-anchor" href="#Discrete-Fibre-Derivative">Discrete Fibre Derivative</a><a id="Discrete-Fibre-Derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Fibre-Derivative" title="Permalink"></a></h2><p>Quite often it is more practical to prescribe an initial position and momentum instead of the configuration of the first two time steps. We therefore want to define the discrete momentum <span>$p_{n}$</span> at time step <span>$n$</span>. In the continuous setting this was done with the help of the fibre derivative. However, in the discrete setting, we have two ways to define discrete fibre derivatives,</p><p class="math-container">\[\mathbb{F}^{-} L_{d} , \, \mathbb{F}^{+} L_{d} : \mf{M} \times \mf{M} \rightarrow \cb{\mf{M}} ,\]</p><p>which map the discrete state space <span>$\mf{M} \times \mf{M}$</span> to the tangent bundle <span>$\cb{\mf{M}}$</span>. They are given by</p><p class="math-container">\[\begin{aligned}
\mathbb{F}^{-} L_{d} : (q_{n}, q_{n+1}) &amp;\mapsto (q_{n},   p_{n})   = \big( q_{n}  , - D_{1} L_{d} (q_{n}, q_{n+1}) \big) , \\
\mathbb{F}^{+} L_{d} : (q_{n}, q_{n+1}) &amp;\mapsto (q_{n+1}, p_{n+1}) = \big( q_{n+1},   D_{2} L_{d} (q_{n}, q_{n+1}) \big) .
\end{aligned}\]</p><p>The discrete Euler-Lagrange equations can now be rewritten as</p><p class="math-container">\[\mathbb{F}^{+} L_{d} (q_{n-1}, q_{n}) = \mathbb{F}^{-} L_{d} (q_{n}, q_{n+1}) ,\]</p><p>that is</p><p class="math-container">\[\begin{equation}\label{eq:vi-momentum}
p_{n} = D_{2} L_{d} (q_{n-1}, q_{n}) = - D_{1} L_{d} (q_{n}, q_{n+1}) .
\end{equation}\]</p><p><strong>TODO</strong>: Add composition maps of fibre derivatives and Lagrangian evolution map corresponding to the Hamiltonian evolution map.</p><p>Thus the discrete fibre derivatives permit a new interpretation of the discrete Euler–Lagrange equations. The variational integrator can be rewritten in position-momentum form,</p><p class="math-container">\[\begin{equation}\label{eq:vi-position-momentum}
\begin{aligned}
p_{n  } &amp;=           -  D_{1} L_{d} (q_{n}, q_{n+1}) , \\
p_{n+1} &amp;= \hphantom{-} D_{2} L_{d} (q_{n}, q_{n+1}) .
\end{aligned}
\end{equation}\]</p><p>Given <span>$(q_{n}, p_{n})$</span>, the first equation can be solved for <span>$q_{n+1}$</span>. This is generally a nonlinearly implicit equation that has to be solved by some iterative technique like Newton&#39;s method. The second equation is an explicit function, so to obtain <span>$p_{n+1}$</span> we merely have to plug in <span>$q_{n}$</span> and <span>$q_{n+1}$</span>. The corresponding Hamiltonian evolution map is</p><p class="math-container">\[\begin{equation}\label{eq:vi-evolution_map_position_momentum}
\tilde{\varphi}_{h}
\; : \; \cb{\mf{M}} \rightarrow \cb{\mf{M}}
\; : \; ( q_{n}, p_{n} ) \mapsto ( q_{n+1}, p_{n+1} ) .
\end{equation}\]</p><p>Thus, starting with an initial position <span>$q_{0}$</span> and an initial momentum <span>$p_{0}$</span>, the repeated solution of <span>$\tilde{\varphi}_{h}$</span> gives the same discrete trajectory <span>$\{ q_{n} \}_{n=0}^{N}$</span> as the repeated solution of <span>$\varphi_{h}$</span>. The position-momentum form, as a one-step method, is usually easier to implement than the discrete Euler-Lagrange equations. And for most problems, initial conditions are more naturally prescribed via the position and momentum of the particle at a given point in time, <span>$(q_{0}, p_{0})$</span>. If, however, only the position of the particle at two points in time, <span>$(q_{0}, q_{1})$</span>, is known, the Euler-Lagrange equations are the more natural way of describing the dynamics.</p><p>This of course is just reflecting the difference in the Lagrangian and Hamiltonian point of view. For <span>$d$</span> degrees of freedom, the variational principle leads to <span>$d$</span> differential equations of second order. Hamilton&#39;s equations, on the other hand, are <span>$2d$</span> differential equations of first order. Which form is more convenient to use largely depends on the problem at hand.</p><h4 id="Example:-Point-Particle"><a class="docs-heading-anchor" href="#Example:-Point-Particle">Example: Point Particle</a><a id="Example:-Point-Particle-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Point-Particle" title="Permalink"></a></h4><p>Consider a particle with mass <span>$m$</span>, moving in some potential <span>$V$</span>. Its continuous Lagrangian is</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1_lagrangian}
L (q, \dot{q}) = \dfrac{1}{2} \, m \dot{q}^{2} - V(q)
\end{equation}\]</p><p>Approximated by the trapezoidal rule, the discrete Lagrangian reads</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1-lagrangian-trapezoidal}
L_{d}^{\text{tr}} (q_{n}, q_{n+1}) = h \, \bigg[ \dfrac{m}{2} \bigg( \dfrac{q_{n+1} - q_{n}}{h} \bigg)^{2} - \dfrac{V (q_{n}) + V (q_{n+1})}{2} \bigg] .
\end{equation}\]</p><p>Applying the discrete Euler-Lagrange equations \eqref{eq:vi-deleqs} to this expression results in discrete equations of motion</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1_deleqs_trapezoidal}
m \, \dfrac{q_{n+1} - 2 \, q_{n} + q_{n-1}}{h^{2}} = - \nabla V (q_{n})
\end{equation}\]</p><p>which clearly are a discrete version of Newton&#39;s second law</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1-newton}
m \ddot{q} = - \nabla V = F .
\end{equation}\]</p><p>For comparison, consider also the midpoint approximation</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1-lagrangian-midpoint}
L_{d}^{\text{mp}} (q_{n}, q_{n+1}) = h \, \bigg[ \dfrac{m}{2} \, \bigg( \dfrac{q_{n+1} - q_{n}}{h} \bigg)^{2} - V \bigg( \dfrac{q_{n} + q_{n+1}}{2} \bigg) \bigg]
\end{equation}\]</p><p>which leads to</p><p class="math-container">\[\begin{equation}\label{eq:vi-example1_deleqs_midpoint}
m \, \dfrac{q_{n+1} - 2 \, q_{n} + q_{n-1}}{h^{2}} = - \dfrac{1}{2} \, \bigg[ \nabla V \bigg( \dfrac{q_{n-1} + q_{n}}{2} \bigg) + \nabla V \bigg( \dfrac{q_{n} + q_{n+1}}{2} \bigg) \bigg]
\end{equation}\]</p><p>and thus a different discretisation of \eqref{eq:vi-example1-newton}. The position-momentum form \eqref{eq:vi-position-momentum} of the trapezoidal Lagrangian \eqref{eq:vi-example1-lagrangian-trapezoidal} can be written as</p><p class="math-container">\[\begin{aligned}
\dfrac{q_{n+1} - q_{n}}{h} &amp;= \; \dfrac{1}{m} \, \bigg[ p_{n} - \dfrac{h}{2} \, \nabla V (q_{n}) \bigg] \\
\dfrac{p_{n+1} - p_{n}}{h} &amp;= -  \dfrac{1}{2} \, \bigg[ \nabla V (q_{n}) + \nabla V (q_{n+1}) \bigg]
\end{aligned}\]</p><p>and the one of the midpoint Lagrangian \eqref{eq:vi-example1-lagrangian-midpoint} reads</p><p class="math-container">\[\begin{aligned}
\dfrac{q_{n+1} - q_{n}}{h} &amp;= \dfrac{1}{m} \, \bigg[ p_{n} - \dfrac{h}{2} \, \nabla V \bigg( \dfrac{q_{n} + q_{n+1}}{2} \bigg) \bigg] \\
\dfrac{p_{n+1} - p_{n}}{h} &amp;= - \nabla V \bigg( \dfrac{q_{n} + q_{n+1}}{2} \bigg) .
\end{aligned}\]</p><p>This bears a close resemblance of Hamilton&#39;s equations of motion, where the additional term in the first equations can be interpreted as extrapolating the momentum <span>$p_{n}$</span> to <span>$t_{n+1/2}$</span>. As already noted, it is not always so easy to solve the first equation in \eqref{eq:vi-position-momentum} for <span>$q_{n+1}$</span>. In general this is an implicit equation.</p><h2 id="Discrete-Symplectic-Form"><a class="docs-heading-anchor" href="#Discrete-Symplectic-Form">Discrete Symplectic Form</a><a id="Discrete-Symplectic-Form-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Symplectic-Form" title="Permalink"></a></h2><p>As in the continuous case, the discrete one-form is obtained by computing the variation of the action for varying endpoints</p><p class="math-container">\[\begin{aligned}
\ext \mathcal{A}_{d} [q_{d}] \cdot v_{d}
\nonumber
&amp;= \sum \limits_{n=0}^{N-1} \big[ D_{1} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n} + D_{2} \, L_{d} (q_{n}, q_{n+1}) \cdot v_{n+1} \big] \\
\nonumber
&amp;= \sum \limits_{n=1}^{N-1} \big[ D_{1} \, L_{d} (q_{n}, q_{n+1}) + D_{2} \, L_{d} (q_{n-1}, q_{n}) \big] \cdot v_{n} \\
&amp;\hspace{3em}
+ D_{1} \, L_{d} (q_{0}, q_{1}) \cdot v_{0} + D_{2} \, L_{d} (q_{N-1}, q_{N}) \cdot v_{N} .
\end{aligned}\]</p><p>The two latter terms originate from the variation at the boundaries. They form the discrete counterpart of the Lagrangian one-form. However, there are two boundary terms that define two distinct one-forms on <span>$\mf{M} \times \mf{M}$</span>,</p><p class="math-container">\[\begin{aligned}
\begin{array}{ll}
\Theta_{L_{d}}^{-} ( q_{0}  , q_{1} ) \cdot ( v_{0}   , v_{1} ) &amp;\equiv           -  D_{1} L_{d} (q_{0},   q_{1}) \cdot v_{0} , \\
\Theta_{L_{d}}^{+} ( q_{N-1}, q_{N} ) \cdot ( v_{N-1} , v_{N} ) &amp;\equiv \hphantom{-} D_{2} L_{d} (q_{N-1}, q_{N}) \cdot v_{N} .
\end{array}
\end{aligned}\]</p><p>In general, these one-forms are defined as</p><p class="math-container">\[\begin{equation}\label{eq:vi-discrete-one-form}
\begin{aligned}
\Theta_{L_{d}}^{-} ( q_{n} , q_{n+1} ) &amp;\equiv           -  D_{1} L_{d} (q_{n}, q_{n+1}) \, \ext q_{n} , \\
\Theta_{L_{d}}^{+} ( q_{n} , q_{n+1} ) &amp;\equiv \hphantom{-} D_{2} L_{d} (q_{n}, q_{n+1}) \, \ext q_{n+1} .
\end{aligned}
\end{equation}\]</p><p>As <span>$\ext L_{d} = \Theta_{L_{d}}^{+} - \Theta_{L_{d}}^{-}$</span> and <span>$\ext^{2} L_{d} = 0$</span> one observes that</p><p class="math-container">\[\ext \Theta_{L_{d}}^{+} = \ext \Theta_{L_{d}}^{-}\]</p><p>such that the exterior derivative of both discrete one-forms defines the same \emph{discrete Lagrangian two-form} or \emph{discrete symplectic form}</p><p class="math-container">\[\begin{equation}\label{eq:vi-discrete_two_form}
\begin{aligned}
\omega_{L_{d}}
&amp;= \ext \Theta_{L_{d}}^{+}
 = \ext \Theta_{L_{d}}^{-}
 = \dfrac{\partial^{2} L_{d} (q_{n}, q_{n+1})}{\partial q_{n } \, \partial q_{n+1}} \, \ext q_{n} \wedge \ext q_{n+1} &amp;
&amp; \text{(no summation over $n$)} .
\end{aligned}
\end{equation}\]</p><p>Consider the exterior derivative of the discrete action \eqref{eq:vi-action}. Upon insertion of the discrete Euler-Lagrange equations \eqref{eq:vi-deleqs} it becomes</p><p class="math-container">\[\begin{equation}\label{eq:vi-symplectic-ext-action}
\ext \mathcal{A}_{d}
= D_{1} L_{d} (q_{0}, q_{1}) \cdot \ext q_{0} + D_{2} L_{d} (q_{N-1}, q_{N}) \cdot \ext q_{N}
= \Theta_{L_{d}}^{+} (q_{N-1}, q_{N}) - \Theta_{L_{d}}^{-} (q_{0}, q_{1}) .
\end{equation}\]</p><p>On the right hand side we find the just defined Lagrangian one-forms \eqref{eq:vi-discrete-one-form}. Taking the exterior derivative of \eqref{eq:vi-symplectic-ext-action} gives</p><p class="math-container">\[\begin{equation}\label{eq:vi-symplectic-preservation}
\omega_{L_{d}} (q_{0}, q_{1}) = \omega_{L_{d}} (q_{N-1}, q_{N}) ,
\end{equation}\]</p><p>where <span>$q_{N-1}$</span> and <span>$q_{N}$</span> are connected with <span>$q_{0}$</span> and <span>$q_{1}$</span> through the discrete Euler-Lagrange equations \eqref{eq:vi-deleqs}. Therefore, \eqref{eq:vi-symplectic-preservation} implies that the discrete symplectic structure <span>$\omega_{L_{d}}$</span> is preserved while the system advances from <span>$t=0$</span> to <span>$t=Nh$</span> according to the discrete equations of motion \eqref{eq:vi-deleqs}. As the number of time steps <span>$N$</span> is arbitrary, the discrete symplectic form <span>$\omega_{L_{d}}$</span> is preserved at all times of the simulation. Note that this does not automatically imply that the continuous symplectic structure <span>$\omega_{L}$</span> is preserved under the discrete map <span>$\varphi_{h}$</span>.</p><p><strong>TODO</strong>: show preservation of the canonical symplectic form by the position-momentum-form</p><h2 id="Discrete-Noether-Theorem"><a class="docs-heading-anchor" href="#Discrete-Noether-Theorem">Discrete Noether Theorem</a><a id="Discrete-Noether-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Noether-Theorem" title="Permalink"></a></h2><p>The discrete Noether theorem, just as the continuous Noether theorem, draws the connection between symmetries of a discrete Lagrangian and quantities that are conserved by the discrete Euler-Lagrange equations or, equivalently, the discrete Lagrangian flow. The continuous theory translates straight forwardly to the discrete case. Therefore, we repeat just the important steps, translated to the discrete setting.</p><p>Consider a one parameter group of discrete curves <span>$q_{d}^{\epsilon} = \{ q_{n}^{\epsilon} \}_{n=0}^{N}$</span> with <span>$q_{n}^{\epsilon} = \sigma^{\epsilon} (t_{n}, q_{n}, \epsilon)$</span> such that <span>$q_{n}^{0} (q_{n}) = q_{n}$</span>, i.e., <span>$\sigma^{0} = \id$</span> (note that <span>$\sigma^{\epsilon}$</span> is the same function as in the continuous case). The discrete Lagrangian <span>$L_{d}$</span> has a symmetry if it is invariant under this transformation</p><p class="math-container">\[\begin{equation}\label{eq:vi_noether_finite_1}
\begin{aligned}
L_{d} \big( q_{n}^{\epsilon}, q_{n+1}^{\epsilon} \big) &amp;= L_{d} \big( q_{n}, q_{n+1} \big) &amp;
&amp; \text{for all $\epsilon$ and $n$} .
\end{aligned}
\end{equation}\]</p><p>The generating vector field of such a symmetry transformation is</p><p class="math-container">\[\begin{equation}\label{eq:vi_noether_finite_2}
X_{n} = \dfrac{\partial \sigma^{\epsilon}}{\partial \epsilon} \bigg\vert_{\epsilon = 0}
\end{equation}\]</p><p>such that</p><p class="math-container">\[\begin{equation}\label{eq:vi-noether-finite-3}
\dfrac{d}{d \epsilon} L_{d} \big( q_{n}^{\epsilon}, q_{n+1}^{\epsilon} \big) \bigg\vert_{\epsilon = 0}
 = D_{1} L_{d} \big( q_{n}, q_{n+1} \big) \cdot X_{n  }
 + D_{2} L_{d} \big( q_{n}, q_{n+1} \big) \cdot X_{n+1} .
\end{equation}\]</p><p>If <span>$\{ q_{n} \}_{n=0}^{N}$</span> solves the discrete Euler-Lagrange equations \eqref{eq:vi-deleqs},</p><p class="math-container">\[\begin{equation}\label{eq:vi_noether_finite_4}
D_{1} \, L_{d} (q_{n}, q_{n+1}) + D_{2} \, L_{d} (q_{n-1}, q_{n}) = 0 ,
\end{equation}\]</p><p>we can replace the first term on the right hand side of \eqref{eq:vi-noether-finite-3} to get</p><p class="math-container">\[\begin{equation}\label{eq:vi_noether_finite_5}
0 = - D_{2} L_{d} \big( q_{n-1}, q_{n} \big) \cdot X_{n}
    + D_{2} L_{d} \big( q_{n}, q_{n+1} \big) \cdot X_{n+1} .
\end{equation}\]</p><p>This amounts to a discrete conservation law of the form</p><p class="math-container">\[\begin{equation}\label{eq:vi_noether_finite_6}
D_{2} L_{d} \big( q_{n-1}, q_{n} \big) \cdot X_{n} = D_{2} L_{d} \big( q_{n}, q_{n+1} \big) \cdot X_{n+1} .
\end{equation}\]</p><p>It states that solutions <span>$\{ q_{n} \}_{n=0}^{N}$</span> of the discrete Euler-Lagrange equations preserve the components of the momentum <span>$p_{n} = D_{2} L_{d} \big( q_{n-1}, q_{n} \big)$</span> in direction <span>$X_{n}$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../splitting/">« Splitting</a><a class="docs-footer-nextpage" href="../vprk/">VPRK »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 4 March 2021 20:41">Thursday 4 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
