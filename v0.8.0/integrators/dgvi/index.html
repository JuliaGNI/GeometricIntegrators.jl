<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discontinuous Galerkin Variational Integrators · GeometricIntegrators.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GeometricIntegrators.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorial/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../equations/">Equations</a></li><li><span class="tocitem">Integrators</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../rk/">Runge-Kutta</a></li><li><a class="tocitem" href="../splitting/">Splitting</a></li><li><a class="tocitem" href="../variational/">Variational</a></li><li><a class="tocitem" href="../vprk/">VPRK</a></li><li><a class="tocitem" href="../spark/">SPARK</a></li><li><a class="tocitem" href="../cgvi/">CGVI</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../../modules/equations/">Equations</a></li><li><a class="tocitem" href="../../modules/integrators/">Integrators</a></li><li><a class="tocitem" href="../../modules/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../modules/simulations/">Simulations</a></li><li><a class="tocitem" href="../../modules/solutions/">Solutions</a></li></ul></li><li><span class="tocitem">Tableaus</span><ul><li><a class="tocitem" href="../../tableaus/rungekutta/">Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/rungekutta_partitioned/">Partitioned Runge-Kutta Methods</a></li><li><a class="tocitem" href="../../tableaus/splitting/">Splitting Methods</a></li><li><a class="tocitem" href="../../tableaus/vprk/">VPRK Methods</a></li><li><a class="tocitem" href="../../tableaus/spark/">SPARK Methods</a></li></ul></li><li><span class="tocitem">Developer Docs</span><ul><li><a class="tocitem" href="../../developer/code_integration/">Code Integration</a></li><li><a class="tocitem" href="../../developer/custom_integrators/">Custom Integrators</a></li></ul></li><li><a class="tocitem" href="../../releasenotes/">Release Notes</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Discontinuous Galerkin Variational Integrators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discontinuous Galerkin Variational Integrators</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGNI/GeometricIntegrators.jl/blob/master/docs/src/integrators/dgvi.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="dgvi"><a class="docs-heading-anchor" href="#dgvi">Discontinuous Galerkin Variational Integrators</a><a id="dgvi-1"></a><a class="docs-heading-anchor-permalink" href="#dgvi" title="Permalink"></a></h1><p>Discontinuous Galerkin Variational Integrators (DGVIs) are a family of integrators for degenerate Lagrangian systems and for Hamiltonian systems subject to Dirac constraints. For integrators for non-degenerate (regular) Lagrangian and unconstrained Hamiltonian systems see <a href="../hpg/#hpg">Hamilton-Pontryagin-Galerkin (HPG) Integrators</a>.</p><h2 id="Degenerate-Lagrangian-Systems"><a class="docs-heading-anchor" href="#Degenerate-Lagrangian-Systems">Degenerate Lagrangian Systems</a><a id="Degenerate-Lagrangian-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Degenerate-Lagrangian-Systems" title="Permalink"></a></h2><p>Consider a fully degenerate Lagrangian system of the form</p><p class="math-container">\[L(q, \dot{q}) = \vartheta (q) \cdot \dot{q} - H(q) ,\]</p><p>where <span>$\vartheta (q)$</span> denotes the Cartan one-form and <span>$H(q)$</span> the Hamiltonian, that is usually given by the total energy of the system.</p><h2 id="Discrete-Trajectories-and-Numerical-Quadrature"><a class="docs-heading-anchor" href="#Discrete-Trajectories-and-Numerical-Quadrature">Discrete Trajectories and Numerical Quadrature</a><a id="Discrete-Trajectories-and-Numerical-Quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Trajectories-and-Numerical-Quadrature" title="Permalink"></a></h2><p>The first step in the derivation of variational integrators is the discretization of the action integral</p><p class="math-container">\[\mathcal{A} [q] = \int \limits_{0}^{T} L(q(t), \dot{q}(t)) \, dt .\]</p><p>To this end, the interval <span>$[0,T]$</span> is split into <span>$N$</span> sub-intervals <span>$[t_{n}, t_{n+1}]$</span> with <span>$t_n = nh$</span> and <span>$h$</span> the time step size, so that <span>$t_N = T$</span> and the action can be written as</p><p class="math-container">\[\mathcal{A} [q] = \sum \limits_{n=0}^{N-1} \int \limits_{[t_{n}, t_{n+1}]} L(q(t), \dot{q}(t)) \, dt .\]</p><p>Within each interval <span>$(t_{n}, t_{n+1})$</span> a piecewise-polynomial approximation <span>$q_h$</span> of the trajectory <span>$q$</span> is constructed using <span>$S$</span> basis functions <span>$\varphi_{i}$</span>,</p><p class="math-container">\[q_h(t) \vert_{(t_{n}, t_{n+1})} = \sum \limits_{i=1}^{S} x_{n,i} \, \bar{\varphi}_{n,i} (t) ,\]</p><p>where <span>$\bar{\varphi}_{n,i} (t)$</span> is a rescaled basis function, defined by</p><p class="math-container">\[\bar{\varphi}_{n,i} (t) = \varphi_{i} \bigg( \frac{t - t_{n}}{t_{n+1} - t_{n}} \bigg) ,\]</p><p>and it is assumed that <span>$\varphi_{i}$</span> is compactly supported on <span>$[0,1]$</span>. These approximations <span>$q_h(t)$</span> do not need to be continuous across interval boundaries but are indeed allowed to have jumps. Replacing the continuous trajectory <span>$q$</span> in the action with <span>$q_h$</span>, we obtain</p><p class="math-container">\[\mathcal{A} [q_h] = \sum \limits_{n=0}^{N-1} \int \limits_{(t_{n}, t_{n+1})} \big[ \vartheta (q_h (t)) \cdot \dot{q}_h (t) - H(q_h (t)) \big] \, dt
+ \sum \limits_{n=1}^{N-1} [[ \vartheta (q_h (t)) \cdot \dot{q}_h (t) ]]_{t=t_n}  .\]</p><p>The integral of the Hamiltonian <span>$H(q_h)$</span> over the interval boundaries does not contribute to the integral, differently from the term <span>$\vartheta (q_h) \cdot \dot{q_h}$</span>, which will determine the numerical flux <span>$[[ \cdot ]]_n$</span> at <span>$t_n$</span> of the Discontinuous Galerkin method. The approximation of this term will be discussed below. In order to obtain a fully discrete action, a numerical quadrature rule with <span>$R$</span> nodes <span>$c_i$</span> and weights <span>$b_i$</span> is introduced for the approximation of the integral,</p><p class="math-container">\[\mathcal{A}_d [x_d] = h \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} b_i \big[ \vartheta (q_h(t_n + c_i h)) \cdot \dot{q}_h (t_n + c_i h) - H(q_h(t_n + c_i h)) \big]
+ \sum \limits_{n=1}^{N-1} [[ \vartheta (q_h (t)) \cdot \dot{q}_h (t) ]]_{t=t_n} .\]</p><p>Here, <span>$x_d$</span> denotes the vector of all the degrees of freedom, i.e.,</p><p class="math-container">\[x_d = ( x_{0,1}, ..., x_{0,S}, \, x_{1,1}, ..., x_{N-2,S}, \, x_{N-1,1}, ..., x_{N-1,S} )^T .\]</p><p>In order to write the discrete action in a more explicit form, mass and derivative matrices <span>$m$</span> and <span>$a$</span> are introduced, whose elements are given by</p><p class="math-container">\[m_{ij} = \varphi_j (c_i) ,
\qquad
a_{ij} = \varphi_j&#39; (c_i) ,
\qquad
i = 1, ..., R ,
\;
j = 1, ..., S ,\]</p><p>so that the solution and its time derivative at the quadrature points can be written as</p><p class="math-container">\[Q_{n,i} \equiv q_h(t_n + c_i h) = m_{ij} x_{n,j} ,
\qquad
V_{n,i} \equiv \dot{q}_h (t_n + c_i h) = a_{ij} x_{n,j} ,\]</p><p>where</p><p class="math-container">\[x_{n} = ( x_{n,1}, ..., x_{n,S} )^T\]</p><p>is the vector containing the degrees of freedom of <span>$q_h \vert_{[t_{n}, t_{n+1}]}$</span>. Using these definitions, the discrete action can be written as</p><p class="math-container">\[\mathcal{A}_d [x_d] = h \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} b_i \big[ \vartheta (Q_{n,i}) \cdot V_{n,i} - H(Q_{n,i}) \big]
+ \sum \limits_{n=1}^{N-1} [[ \vartheta (q_h (t)) \cdot \dot{q}_h (t) ]]_{t=t_n} .\]</p><h2 id="Numerical-Fluxes"><a class="docs-heading-anchor" href="#Numerical-Fluxes">Numerical Fluxes</a><a id="Numerical-Fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Fluxes" title="Permalink"></a></h2><p>In the following, the solution values &quot;left&quot; and &quot;right&quot; of the jump will be needed. This will be denoted by <span>$q_n^-$</span> and <span>$q_n^+$</span>, respectively. Usually, these just correspond to the polynomials on the left and right, evaluated at <span>$t_n$</span>, i.e.,</p><p class="math-container">\[q_n^- = \lim_{t \uparrow t_n} q_h (t) = q_h \vert_{[t_{n-1}, t_{n}]} (t_n) ,
\qquad
q_n^+ = \lim_{t \downarrow t_n} q_h (t) = q_h \vert_{[t_{n}, t_{n+1}]} (t_n) .\]</p><p>In principle, however, more general reconstructions of the solution could be used. In the following, it will be assumed, that <span>$q_n^-$</span> is given by some linear combinations of the degrees of freedom of the polynomial on the left interval and correspondingly that <span>$q_n^+$</span> is given by some linear combinations of the degrees of freedom of the polynomial on the right interval, specifically</p><p class="math-container">\[q_n^- = r^{-} \cdot x_{n} ,
\qquad
q_n^+ = r^{+} \cdot x_{n+1} ,\]</p><p>where <span>$r^{\pm}$</span> are appropriate coefficient vectors.</p><h4 id="Gauge-Terms"><a class="docs-heading-anchor" href="#Gauge-Terms">Gauge Terms</a><a id="Gauge-Terms-1"></a><a class="docs-heading-anchor-permalink" href="#Gauge-Terms" title="Permalink"></a></h4><p>The Lagrangian <span>$L$</span> can be augmented with any total time derivative without changing the (continuous) Euler-Lagrange equations. In particular, one can consider the modified Lagrangian</p><p class="math-container">\[L&#39;(q, \dot{q}) = \vartheta (q) \cdot \dot{q} - H(q) - \nu \dfrac{d}{dt} \bigg( \vartheta (q) \cdot q \bigg) .\]</p><p>While this gauge term vanishes in the continuous case, it takes a finite value across jumps of the discontinuous discrete solution, so that the modified discrete action reads</p><p class="math-container">\[\mathcal{A}_d&#39; [x_d] = h \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} b_i \big[ \vartheta (Q_{n,i}) \cdot V_{n,i} - H(Q_{n,i}) \big]
+ \sum \limits_{n=1}^{N-1} \bigg[\bigg[ \vartheta (q_h (t)) \cdot \dot{q}_h (t) - \nu \dfrac{d}{dt} \bigg( \vartheta (q) \cdot q \bigg) \bigg]\bigg]_{t=t_n} .\]</p><p>In the following, only the modified Lagrangian and action will be considered, in order to obtain a sufficiently general framework for constructing numerical fluxes. For brevity of notation, the prime will be dropped.</p><h4 id="Total-Time-Derivatives-Across-Jumps"><a class="docs-heading-anchor" href="#Total-Time-Derivatives-Across-Jumps">Total Time Derivatives Across Jumps</a><a id="Total-Time-Derivatives-Across-Jumps-1"></a><a class="docs-heading-anchor-permalink" href="#Total-Time-Derivatives-Across-Jumps" title="Permalink"></a></h4><p>The computation of the total time derivative in the gauge term is simple, at least in the distributional sense. Even though both, <span>$\vartheta (q_h)$</span> and <span>$q_h$</span> have a jump, the jump occurs at the same position in time, so that the derivative can be computed as</p><p class="math-container">\[\dfrac{d}{dt} \bigg( \vartheta (q_h) \cdot q_h \bigg) \bigg\vert_{t=t_n}
= \dfrac{d}{dt} \bigg( \vartheta (q_n^-) \cdot q_n^- \, \Theta (t_n - t) + \vartheta (q_n^+) \cdot q_n^+ \, \Theta (t - t_n) \bigg) ,\]</p><p>where <span>$\Theta$</span> denotes the Heaviside function. This can be explicitly computed as</p><p class="math-container">\[\dfrac{d}{dt} \bigg( \vartheta (q_h) \cdot q_h \bigg) \bigg\vert_{t=t_n}
= - \vartheta (q_n^-) \cdot q_n^- \, \delta (t_n) + \vartheta (q_n^+) \cdot q_n^+ \, \delta (t_n)
= [[ \vartheta (q_h) \cdot q_h ]]_{t=t_n} \, \delta (t_n) ,\]</p><p>with <span>$\delta (t_n)$</span> the Dirac delta-function at <span>$t_n$</span>.</p><h4 id="Non-conservative-Products"><a class="docs-heading-anchor" href="#Non-conservative-Products">Non-conservative Products</a><a id="Non-conservative-Products-1"></a><a class="docs-heading-anchor-permalink" href="#Non-conservative-Products" title="Permalink"></a></h4><p>Simple means for integrating the Lagrangian across jumps are provided by discretisations of the integral</p><p class="math-container">\[\int \limits_0^1 \vartheta (\Phi(\tau; q^-, q^+)) \cdot \dfrac{d \Phi(\tau; q^-, q^+)}{d\tau} \, d\tau ,\]</p><p>where <span>$\Phi$</span> is a path connecting the solution values <span>$q^-$</span> and <span>$q^+$</span> on the left and the right of the jump. Upon picking a quadrature rule with <span>$\sigma$</span> nodes <span>$\gamma_i$</span> and corresponding weights <span>$\beta_i$</span>, the discrete product takes the form</p><p class="math-container">\[\sum \limits_{i=1}^{\sigma} \beta_i \, \vartheta \big( \Phi (\gamma_i; q_{n}^- , q_{n}^+) \big) \cdot \dfrac{d\Phi}{d\tau} (\gamma_i; q_{n}^- , q_{n}^+) .\]</p><p>For a compact notation, &quot;mass&quot; and &quot;derivative&quot; vectors <span>$\mu^{\pm}$</span> and <span>$\alpha^{\pm}$</span> are introduced, so that</p><p class="math-container">\[\Phi (\gamma_i; q_{n}^- , q_{n}^+) = \mu^-_i q_{n}^- + \mu^+_i q_{n}^+
\qquad
\Phi&#39; (\gamma_i; q_{n}^- , q_{n}^+) = \alpha^-_i q_{n}^- + \alpha^+_i q_{n}^+ ,\]</p><p>and the discrete product can be written as</p><p class="math-container">\[\sum \limits_{i=1}^{\sigma} \beta_i \, \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i q_{n}^- + \alpha^+_i q_{n}^+ ) .\]</p><p>Providing the path <span>$\Phi$</span> by two functions <span>$\phi^{\pm}(\tau)$</span>, so that</p><p class="math-container">\[\phi(\tau; q^-, q^+) = q^- \phi^{-}(\tau) + q^+ \phi^{+}(\tau) ,\]</p><p>the components of the &quot;mass&quot; and &quot;derivative&quot; vectors are given by</p><p class="math-container">\[\mu^-_i = \phi^{-} (\gamma_i) ,
\qquad
\mu^+_i = \phi^{+} (\gamma_i) ,\]</p><p>and</p><p class="math-container">\[\alpha^-_i = \frac{d\phi^{-}}{d\tau} (\gamma_i) ,
\qquad
\alpha^+_i = \frac{d\phi^{+}}{d\tau} (\gamma_i) ,\]</p><p>respectively.</p><h2 id="Discrete-Variational-Principle"><a class="docs-heading-anchor" href="#Discrete-Variational-Principle">Discrete Variational Principle</a><a id="Discrete-Variational-Principle-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Variational-Principle" title="Permalink"></a></h2><p>Using the construction of the previous sections, the discrete action reads</p><p class="math-container">\[\mathcal{A}_d [x_d] = h \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} b_i \big[ \vartheta (Q_{n,i}) \cdot V_{n,i} - H(Q_{n,i}) \big] \\
+ \sum \limits_{n=1}^{N-1} \bigg[ \sum \limits_{i=1}^{\sigma} \beta_i \, \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i q_{n}^- + \alpha^+_i q_{n}^+ )
- \nu \big[ \vartheta (q_n^+) \cdot q_n^+ - \vartheta (q_n^-) \cdot q_n^- \big] \bigg] .\]</p><p>The discrete Euler-Lagrange equations are obtained by applying Hamilton&#39;s principle of stationary action to <span>$\mathcal{A}_d [x_d]$</span>, that is requiring that <span>$\delta \mathcal{A}_d [x_d] = 0$</span>. The variations of the discrete action are computed as follows,</p><p class="math-container">\[\delta \mathcal{A}_d [x_d]
= h \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} b_i \big[ \delta Q_{n,i} \cdot \nabla \vartheta (Q_{n,i}) \cdot V_{n,i} + \vartheta (Q_{n,i}) \cdot \delta V_{n,i} - \delta Q_{n,i} \cdot \nabla H(Q_{n,i}) \big] \\
+ \sum \limits_{n=1}^{N-1} \bigg[ \sum \limits_{i=1}^{\sigma} \beta_i \, \big[ ( \mu^-_i \delta q_{n}^- + \mu^+_i \delta q_{n}^+ ) \cdot \nabla \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i q_{n}^- + \alpha^+_i q_{n}^+ ) + \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i \delta q_{n}^- + \alpha^+_i \delta q_{n}^+ ) \big] \\
- \nu \big[ \delta q_n^+ \cdot \nabla \vartheta (q_n^+) \cdot q_n^+  + \vartheta (q_n^+) \cdot \delta q_n^+ - \delta q_n^- \cdot \nabla \vartheta (q_n^-) \cdot q_n^- - \vartheta (q_n^-) \cdot \delta q_n^- \big] \bigg] .\]</p><p>Using the relations</p><p class="math-container">\[\delta Q_{n,i} = m_{ij} \delta x_{n,j} ,
\qquad
\delta V_{n,i} = \frac{a_{ij}}{h} \delta x_{n,j} ,
\qquad
\delta q_{n}^- = r^{-}_{j} \delta x_{n-1,j} ,
\qquad
\delta q_{n}^+ = r^{+}_{j} \delta x_{n,j} ,\]</p><p>the variations of the discrete action become</p><p class="math-container">\[\delta \mathcal{A}_d [x_d]
= \sum \limits_{n=0}^{N-1} \sum \limits_{i=1}^{R} \sum \limits_{j=1}^{S} b_i \big[ h m_{ij} \delta x_{n,j} \cdot \nabla \vartheta (Q_{n,i}) \cdot V_{n,i} + \vartheta (Q_{n,i}) \cdot a_{ij} \delta x_{n,j} - h m_{ij} \delta x_{n,j} \cdot \nabla H(Q_{n,i}) \big] \\
+ \sum \limits_{n=1}^{N-1} \bigg[ \sum \limits_{i=1}^{\sigma} \sum \limits_{j=1}^{S} \beta_i \, \big[ ( \mu^-_i r^{-}_{j} \delta x_{n-1,j} + \mu^+_i r^{+}_{j} \delta x_{n,j} ) \cdot \nabla \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i q_{n}^- + \alpha^+_i q_{n}^+ ) + \vartheta ( \mu^-_i q_{n}^- + \mu^+_i q_{n}^+ ) \cdot ( \alpha^-_i r^{-}_{j} \delta x_{n-1,j} + \alpha^+_i r^{+}_{j} \delta x_{n,j} ) \big] \\
- \nu \big[ r^{+}_{j} \delta x_{n,j} \cdot \nabla \vartheta (q_n^+) \cdot q_n^+  + \vartheta (q_n^+) \cdot r^{+}_{j} \delta x_{n,j} - r^{-}_{j} \delta x_{n-1,j} \cdot \nabla \vartheta (q_n^-) \cdot q_n^- - \vartheta (q_n^-) \cdot r^{-}_{j} \delta x_{n-1,j} \big] \bigg] .\]</p><p>Requiring the variation of the discrete action to vanish yields the discrete equations of motion,</p><p class="math-container">\[0 = \sum \limits_{i=1}^{R} b_i \big[ h m_{ij} \nabla \vartheta (Q_{n,i}) \cdot V_{n,i} + a_{ij} \vartheta (Q_{n,i}) - h m_{ij} \nabla H(Q_{n,i}) \big] \\
+ \bigg[ \sum \limits_{i=1}^{\sigma} \beta_i \, \big[
   \mu^-_i r^{-}_{j} \nabla \vartheta ( \mu^-_i q_{n+1}^- + \mu^+_i q_{n+1}^+ ) \cdot ( \alpha^-_i q_{n+1}^- + \alpha^+_i q_{n+1}^+ )
 + \mu^+_i r^{+}_{j} \nabla \vartheta ( \mu^-_i q_{n  }^- + \mu^+_i q_{n  }^+ ) \cdot ( \alpha^-_i q_{n  }^- + \alpha^+_i q_{n  }^+ ) \\
 + \vartheta ( \mu^-_i q_{n+1}^- + \mu^+_i q_{n+1}^+ ) \alpha^-_i r^{-}_{j}
 + \vartheta ( \mu^-_i q_{n  }^- + \mu^+_i q_{n  }^+ ) \alpha^+_i r^{+}_{j}
   \big] \\
 - \nu \big[
     r^{+}_{j} \nabla \vartheta (q_{n  }^+) \cdot q_{n  }^+ + r^{+}_{j} \vartheta (q_{n  }^+)
   - r^{-}_{j} \nabla \vartheta (q_{n+1}^-) \cdot q_{n+1}^- - r^{-}_{j} \vartheta (q_{n+1}^-)
   \big]
 \bigg] ,\]</p><p>for all <span>$n$</span> and all <span>$j$</span>.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 4 March 2021 20:41">Thursday 4 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
